

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Tung">
  <meta name="keywords" content="TungÁöÑ‰∏™‰∫∫‰∏ªÈ°µ">
  
    <meta name="description" content="‰∏Ä„ÄÅDocker ÁÆÄ‰ªã Docker ‰∏§‰∏™‰∏ªË¶ÅÈÉ®‰ª∂Ôºö  Docker: ÂºÄÊ∫êÁöÑÂÆπÂô®ËôöÊãüÂåñÂπ≥Âè∞ Docker Hub: Áî®‰∫éÂàÜ‰∫´„ÄÅÁÆ°ÁêÜ Docker ÂÆπÂô®ÁöÑ Docker SaaS Âπ≥Âè∞ ‚Äì¬†Docker Hub  Docker ‰ΩøÁî®ÂÆ¢Êà∑Á´Ø-ÊúçÂä°Âô® (C&#x2F;S) Êû∂ÊûÑÊ®°Âºè„ÄÇDocker ÂÆ¢Êà∑Á´Ø‰ºö‰∏é Docker ÂÆàÊä§ËøõÁ®ãËøõË°åÈÄö‰ø°„ÄÇDocker ÂÆàÊä§ËøõÁ®ã‰ºöÂ§ÑÁêÜÂ§çÊùÇÁπÅÈáçÁöÑ‰ªªÂä°Ôºå‰æãÂ¶ÇÂª∫Á´ã„ÄÅËøêË°å„ÄÅÂèëÂ∏É‰Ω†ÁöÑ D">
<meta property="og:type" content="article">
<meta property="og:title" content="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞">
<meta property="og:url" content="http://www.tung7.com/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/detail_docker_study_note.html">
<meta property="og:site_name" content="TungÁöÑ‰∏™‰∫∫‰∏ªÈ°µ">
<meta property="og:description" content="‰∏Ä„ÄÅDocker ÁÆÄ‰ªã Docker ‰∏§‰∏™‰∏ªË¶ÅÈÉ®‰ª∂Ôºö  Docker: ÂºÄÊ∫êÁöÑÂÆπÂô®ËôöÊãüÂåñÂπ≥Âè∞ Docker Hub: Áî®‰∫éÂàÜ‰∫´„ÄÅÁÆ°ÁêÜ Docker ÂÆπÂô®ÁöÑ Docker SaaS Âπ≥Âè∞ ‚Äì¬†Docker Hub  Docker ‰ΩøÁî®ÂÆ¢Êà∑Á´Ø-ÊúçÂä°Âô® (C&#x2F;S) Êû∂ÊûÑÊ®°Âºè„ÄÇDocker ÂÆ¢Êà∑Á´Ø‰ºö‰∏é Docker ÂÆàÊä§ËøõÁ®ãËøõË°åÈÄö‰ø°„ÄÇDocker ÂÆàÊä§ËøõÁ®ã‰ºöÂ§ÑÁêÜÂ§çÊùÇÁπÅÈáçÁöÑ‰ªªÂä°Ôºå‰æãÂ¶ÇÂª∫Á´ã„ÄÅËøêË°å„ÄÅÂèëÂ∏É‰Ω†ÁöÑ D">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091033_189.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091034_223.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091034_634.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091035_252.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091035_900.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091035_912.png">
<meta property="article:published_time" content="2016-08-06T14:26:56.000Z">
<meta property="article:modified_time" content="2023-05-12T16:15:13.971Z">
<meta property="article:author" content="Tung7">
<meta property="article:tag" content="docker">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://static.open-open.com/lib/uploadImg/20150212/20150212091033_189.png">
  
  
  
  <title>ÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞ - TungÁöÑ‰∏™‰∫∫‰∏ªÈ°µ</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.tung7.com","root":"/","version":"1.9.4","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.0.0-rc1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 50vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Tung7</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="2iconfont 2icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="2iconfont 2icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="2iconfont 2icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="2iconfont 2icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" false
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">ÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞</span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Tung
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2016-08-06 22:26" pubdate>
          22:26 August 6, 2016
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    

    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid post-container nopadding-x">
  <div class="side-col side-col-post-left" style="padding-top:0!important;"></div>
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2 side-col-post-left" style="padding-top:0!important;">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="‰ªñÂ±±‰πãÁü≥"
        id="heading-560b6e30e9355efbb4706b7eedbf6b2c" role="tab" data-toggle="collapse" href="#collapse-560b6e30e9355efbb4706b7eedbf6b2c"
        aria-expanded="true"
      >üìÅ‰ªñÂ±±‰πãÁü≥
        <span class="list-group-count">(4)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-560b6e30e9355efbb4706b7eedbf6b2c"
           role="tabpanel" aria-labelledby="heading-560b6e30e9355efbb4706b7eedbf6b2c">
        
        
          
  <div class="category-post-list">

    
    
      

      

      

      
        <a href="/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/detail_docker_study_note.html" title="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">üìÑÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞</span>
        </a>
      
    
      

      

      

      
        <a href="/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/introduction_swarm.html" title="Ê∑±ÂÖ•ÊµÖÂá∫Swarm"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">üìÑÊ∑±ÂÖ•ÊµÖÂá∫Swarm</span>
        </a>
      
    
      

      

      

      
        <a href="/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/DDD%E5%B3%B0%E4%BC%9A2020%E6%91%98%E5%BD%95.html" title="DDDÂ≥∞‰ºö2020ÊëòÂΩï"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">üìÑDDDÂ≥∞‰ºö2020ÊëòÂΩï</span>
        </a>
      
    
      

      

      
        
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <div id="post-icon">üìù</div>
          <article class="post-content mx-auto">
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
<!--      <i class="iconfont icon-books"></i>-->
        üóÇÔ∏è

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E4%BB%96%E5%B1%B1%E4%B9%8B%E7%9F%B3/" class="category-chain-item"   >‰ªñÂ±±‰πãÁü≥</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
<!--      <i class="iconfont icon-tags"></i>-->
        üè∑Ô∏è
        <a href="/tags/docker/">#docker</a>
      
    </div>
  
</div>

            </div>
            <hr style="border-bottom: 2px solid #b18082">
            <!-- SEO header -->
            <h1 style="display: none">ÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="‰∏Ä„ÄÅDocker-ÁÆÄ‰ªã"><a class="header-anchor" href="#‰∏Ä„ÄÅDocker-ÁÆÄ‰ªã"></a>‰∏Ä„ÄÅDocker ÁÆÄ‰ªã</h1>
<p>Docker ‰∏§‰∏™‰∏ªË¶ÅÈÉ®‰ª∂Ôºö</p>
<ul>
<li>Docker: ÂºÄÊ∫êÁöÑÂÆπÂô®ËôöÊãüÂåñÂπ≥Âè∞</li>
<li>Docker Hub: Áî®‰∫éÂàÜ‰∫´„ÄÅÁÆ°ÁêÜ Docker ÂÆπÂô®ÁöÑ Docker SaaS Âπ≥Âè∞ ‚Äì¬†<a target="_blank" rel="noopener" href="https://registry.hub.docker.com/search?q=library">Docker Hub</a></li>
</ul>
<p>Docker ‰ΩøÁî®ÂÆ¢Êà∑Á´Ø-ÊúçÂä°Âô® (C/S) Êû∂ÊûÑÊ®°Âºè„ÄÇDocker ÂÆ¢Êà∑Á´Ø‰ºö‰∏é Docker ÂÆàÊä§ËøõÁ®ãËøõË°åÈÄö‰ø°„ÄÇDocker ÂÆàÊä§ËøõÁ®ã‰ºöÂ§ÑÁêÜÂ§çÊùÇÁπÅÈáçÁöÑ‰ªªÂä°Ôºå‰æãÂ¶ÇÂª∫Á´ã„ÄÅËøêË°å„ÄÅÂèëÂ∏É‰Ω†ÁöÑ Docker ÂÆπÂô®„ÄÇDocker ÂÆ¢Êà∑Á´ØÂíåÂÆàÊä§ËøõÁ®ãÂèØ‰ª•ËøêË°åÂú®Âêå‰∏Ä‰∏™Á≥ªÁªü‰∏äÔºåÂΩìÁÑ∂‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® Docker ÂÆ¢Êà∑Á´ØÂéªËøûÊé•‰∏Ä‰∏™ËøúÁ®ãÁöÑ Docker ÂÆàÊä§ËøõÁ®ã„ÄÇDocker ÂÆ¢Êà∑Á´ØÂíåÂÆàÊä§ËøõÁ®ã‰πãÈó¥ÈÄöËøá socket ÊàñËÄÖ RESTful API ËøõË°åÈÄö‰ø°„ÄÇ</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20150212/20150212091033_189.png" srcset="/img/loading.gif" lazyload alt="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑ Docker Â≠¶‰π†Á¨îËÆ∞"></p>
<h2 id="1-1-Docker-ÂÆàÊä§ËøõÁ®ã"><a class="header-anchor" href="#1-1-Docker-ÂÆàÊä§ËøõÁ®ã"></a>1.1 Docker ÂÆàÊä§ËøõÁ®ã</h2>
<p>Â¶Ç‰∏äÂõæÊâÄÁ§∫ÔºåDocker ÂÆàÊä§ËøõÁ®ãËøêË°åÂú®‰∏ÄÂè∞‰∏ªÊú∫‰∏ä„ÄÇÁî®Êà∑Âπ∂‰∏çÁõ¥Êé•ÂíåÂÆàÊä§ËøõÁ®ãËøõË°å‰∫§‰∫íÔºåËÄåÊòØÈÄöËøá Docker ÂÆ¢Êà∑Á´ØÈó¥Êé•ÂíåÂÖ∂ÈÄö‰ø°„ÄÇ</p>
<h2 id="1-2-Docker-ÂÆ¢Êà∑Á´Ø"><a class="header-anchor" href="#1-2-Docker-ÂÆ¢Êà∑Á´Ø"></a>1.2 Docker ÂÆ¢Êà∑Á´Ø</h2>
<p>Docker ÂÆ¢Êà∑Á´ØÔºåÂÆûÈôÖ‰∏äÊòØ docker ÁöÑ‰∫åËøõÂà∂Á®ãÂ∫èÔºåÊòØ‰∏ªË¶ÅÁöÑÁî®Êà∑‰∏é Docker ‰∫§‰∫íÊñπÂºè„ÄÇÂÆÉÊé•Êî∂Áî®Êà∑Êåá‰ª§Âπ∂‰∏î‰∏éËÉåÂêéÁöÑ Docker ÂÆàÊä§ËøõÁ®ãÈÄö‰ø°ÔºåÂ¶ÇÊ≠§Êù•ÂõûÂæÄÂ§ç„ÄÇ</p>
<h2 id="1-3-Docker-ÂÜÖÈÉ®"><a class="header-anchor" href="#1-3-Docker-ÂÜÖÈÉ®"></a>1.3 Docker ÂÜÖÈÉ®</h2>
<p>Ë¶ÅÁêÜËß£ Docker ÂÜÖÈÉ®ÊûÑÂª∫ÔºåÈúÄË¶ÅÁêÜËß£‰ª•‰∏ã‰∏âÁßçÈÉ®‰ª∂Ôºö</p>
<ul>
<li>Docker ÈïúÂÉè - Docker images</li>
<li>Docker ‰ªìÂ∫ì - Docker registeries</li>
<li>Docker ÂÆπÂô® - Docker containers</li>
</ul>
<h3 id="Docker-ÈïúÂÉè"><a class="header-anchor" href="#Docker-ÈïúÂÉè"></a>Docker ÈïúÂÉè</h3>
<p>Docker ÈïúÂÉèÊòØ Docker ÂÆπÂô®ËøêË°åÊó∂ÁöÑÂè™ËØªÊ®°ÊùøÔºåÊØè‰∏Ä‰∏™ÈïúÂÉèÁî±‰∏ÄÁ≥ªÂàóÁöÑÂ±Ç (layers) ÁªÑÊàê„ÄÇDocker ‰ΩøÁî® UnionFS Êù•Â∞ÜËøô‰∫õÂ±ÇËÅîÂêàÂà∞ÂçïÁã¨ÁöÑÈïúÂÉè‰∏≠„ÄÇUnionFS ÂÖÅËÆ∏Áã¨Á´ãÊñá‰ª∂Á≥ªÁªü‰∏≠ÁöÑÊñá‰ª∂ÂíåÊñá‰ª∂Â§π(Áß∞‰πã‰∏∫ÂàÜÊîØ)Ë¢´ÈÄèÊòéË¶ÜÁõñÔºåÂΩ¢Êàê‰∏Ä‰∏™ÂçïÁã¨ËøûË¥ØÁöÑÊñá‰ª∂Á≥ªÁªü„ÄÇÊ≠£Âõ†‰∏∫Êúâ‰∫ÜËøô‰∫õÂ±ÇÁöÑÂ≠òÂú®ÔºåDocker ÊòØÂ¶ÇÊ≠§ÁöÑËΩªÈáè„ÄÇÂΩì‰Ω†ÊîπÂèò‰∫Ü‰∏Ä‰∏™ Docker ÈïúÂÉèÔºåÊØîÂ¶ÇÂçáÁ∫ßÂà∞Êüê‰∏™Á®ãÂ∫èÂà∞Êñ∞ÁöÑÁâàÊú¨Ôºå‰∏Ä‰∏™Êñ∞ÁöÑÂ±Ç‰ºöË¢´ÂàõÂª∫„ÄÇÂõ†Ê≠§Ôºå‰∏çÁî®ÊõøÊç¢Êï¥‰∏™ÂéüÂÖàÁöÑÈïúÂÉèÊàñËÄÖÈáçÊñ∞Âª∫Á´ã(Âú®‰ΩøÁî®ËôöÊãüÊú∫ÁöÑÊó∂ÂÄô‰Ω†ÂèØËÉΩ‰ºöËøô‰πàÂÅö)ÔºåÂè™ÊòØ‰∏Ä‰∏™Êñ∞ ÁöÑÂ±ÇË¢´Ê∑ªÂä†ÊàñÂçáÁ∫ß‰∫Ü„ÄÇÁé∞Âú®‰Ω†‰∏çÁî®ÈáçÊñ∞ÂèëÂ∏ÉÊï¥‰∏™ÈïúÂÉèÔºåÂè™ÈúÄË¶ÅÂçáÁ∫ßÔºåÂ±Ç‰ΩøÂæóÂàÜÂèë Docker ÈïúÂÉèÂèòÂæóÁÆÄÂçïÂíåÂø´ÈÄü„ÄÇ</p>
<h3 id="Docker-‰ªìÂ∫ì"><a class="header-anchor" href="#Docker-‰ªìÂ∫ì"></a>Docker ‰ªìÂ∫ì</h3>
<p>Docker ‰ªìÂ∫ìÁî®Êù•‰øùÂ≠òÈïúÂÉèÔºåÂèØ‰ª•ÁêÜËß£‰∏∫‰ª£Á†ÅÊéßÂà∂‰∏≠ÁöÑ‰ª£Á†Å‰ªìÂ∫ì„ÄÇÂêåÊ†∑ÁöÑÔºåDocker ‰ªìÂ∫ì‰πüÊúâÂÖ¨ÊúâÂíåÁßÅÊúâÁöÑÊ¶ÇÂøµ„ÄÇÂÖ¨ÊúâÁöÑ Docker ‰ªìÂ∫ìÂêçÂ≠óÊòØ Docker Hub„ÄÇDocker Hub Êèê‰æõ‰∫ÜÂ∫ûÂ§ßÁöÑÈïúÂÉèÈõÜÂêà‰æõ‰ΩøÁî®„ÄÇËøô‰∫õÈïúÂÉèÂèØ‰ª•ÊòØËá™Â∑±ÂàõÂª∫ÔºåÊàñËÄÖÂú®Âà´‰∫∫ÁöÑÈïúÂÉèÂü∫Á°Ä‰∏äÂàõÂª∫„ÄÇDocker ‰ªìÂ∫ìÊòØ Docker ÁöÑÂàÜÂèëÈÉ®ÂàÜ„ÄÇ</p>
<h3 id="Docker-ÂÆπÂô®"><a class="header-anchor" href="#Docker-ÂÆπÂô®"></a>Docker ÂÆπÂô®</h3>
<p>Docker ÂÆπÂô®ÂíåÊñá‰ª∂Â§πÂæàÁ±ª‰ººÔºå‰∏Ä‰∏™DockerÂÆπÂô®ÂåÖÂê´‰∫ÜÊâÄÊúâÁöÑÊüê‰∏™Â∫îÁî®ËøêË°åÊâÄÈúÄË¶ÅÁöÑÁéØÂ¢É„ÄÇÊØè‰∏Ä‰∏™ Docker ÂÆπÂô®ÈÉΩÊòØ‰ªé Docker ÈïúÂÉèÂàõÂª∫ÁöÑ„ÄÇDocker ÂÆπÂô®ÂèØ‰ª•ËøêË°å„ÄÅÂºÄÂßã„ÄÅÂÅúÊ≠¢„ÄÅÁßªÂä®ÂíåÂà†Èô§„ÄÇÊØè‰∏Ä‰∏™ Docker ÂÆπÂô®ÈÉΩÊòØÁã¨Á´ãÂíåÂÆâÂÖ®ÁöÑÂ∫îÁî®Âπ≥Âè∞ÔºåDocker ÂÆπÂô®ÊòØ Docker ÁöÑËøêË°åÈÉ®ÂàÜ„ÄÇ</p>
<h2 id="1-4-libcontainer"><a class="header-anchor" href="#1-4-libcontainer"></a>1.4 libcontainer</h2>
<p>Docker ‰ªé 0.9 ÁâàÊú¨ÂºÄÂßã‰ΩøÁî® libcontainer Êõø‰ª£ lxcÔºålibcontainer Âíå Linux Á≥ªÁªüÁöÑ‰∫§‰∫íÂõæÂ¶Ç‰∏ãÔºö</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20150212/20150212091034_223.png" srcset="/img/loading.gif" lazyload alt="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑ Docker Â≠¶‰π†Á¨îËÆ∞"></p>
<ul>
<li>ÂõæÁâáÊù•Ê∫ê:¬†<a target="_blank" rel="noopener" href="http://blog.docker.com/2014/03/docker-0-9-introducing-execution-drivers-and-libcontainer/">Docker 0.9: introducing execution drivers and libcontainer</a></li>
</ul>
<h2 id="1-5-ÂëΩÂêçÁ©∫Èó¥„ÄåNamespaces„Äç"><a class="header-anchor" href="#1-5-ÂëΩÂêçÁ©∫Èó¥„ÄåNamespaces„Äç"></a>1.5 ÂëΩÂêçÁ©∫Èó¥„ÄåNamespaces„Äç</h2>
<h3 id="pid-namespace"><a class="header-anchor" href="#pid-namespace"></a>pid namespace</h3>
<p>‰∏çÂêåÁî®Êà∑ÁöÑËøõÁ®ãÂ∞±ÊòØÈÄöËøá pid namespace ÈöîÁ¶ªÂºÄÁöÑÔºå‰∏î‰∏çÂêå namespace ‰∏≠ÂèØ‰ª•ÊúâÁõ∏Âêå PID„ÄÇÂÖ∑Êúâ‰ª•‰∏ãÁâπÂæÅ:</p>
<ul>
<li>ÊØè‰∏™ namespace ‰∏≠ÁöÑ pid ÊòØÊúâËá™Â∑±ÁöÑ pid=1 ÁöÑËøõÁ®ã(Á±ª‰ºº /sbin/init ËøõÁ®ã)</li>
<li>ÊØè‰∏™ namespace ‰∏≠ÁöÑËøõÁ®ãÂè™ËÉΩÂΩ±ÂìçËá™Â∑±ÁöÑÂêå‰∏Ä‰∏™ namespace ÊàñÂ≠ê namespace ‰∏≠ÁöÑËøõÁ®ã</li>
<li>Âõ†‰∏∫ /proc ÂåÖÂê´Ê≠£Âú®ËøêË°åÁöÑËøõÁ®ãÔºåÂõ†Ê≠§Âú® container ‰∏≠ÁöÑ pseudo-filesystem ÁöÑ /proc ÁõÆÂΩïÂè™ËÉΩÁúãÂà∞Ëá™Â∑± namespace ‰∏≠ÁöÑËøõÁ®ã</li>
<li>Âõ†‰∏∫ namespace ÂÖÅËÆ∏ÂµåÂ•óÔºåÁà∂ namespace ÂèØ‰ª•ÂΩ±ÂìçÂ≠ê namespace ÁöÑËøõÁ®ãÔºåÊâÄ‰ª•Â≠ê namespace ÁöÑËøõÁ®ãÂèØ‰ª•Âú®Áà∂ namespace ‰∏≠ÁúãÂà∞Ôºå‰ΩÜÊòØÂÖ∑Êúâ‰∏çÂêåÁöÑ pid</li>
</ul>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="https://blog.jtlebi.fr/2014/01/05/introduction-to-linux-namespaces-part-3-pid/">Introduction to Linux namespaces ‚Äì Part 3: PID</a></p>
<h3 id="mnt-namespace"><a class="header-anchor" href="#mnt-namespace"></a>mnt namespace</h3>
<p>Á±ª‰ºº chrootÔºåÂ∞Ü‰∏Ä‰∏™ËøõÁ®ãÊîæÂà∞‰∏Ä‰∏™ÁâπÂÆöÁöÑÁõÆÂΩïÊâßË°å„ÄÇmnt namespace ÂÖÅËÆ∏‰∏çÂêå namespace ÁöÑËøõÁ®ãÁúãÂà∞ÁöÑÊñá‰ª∂ÁªìÊûÑ‰∏çÂêåÔºåËøôÊ†∑ÊØè‰∏™ namespace ‰∏≠ÁöÑËøõÁ®ãÊâÄÁúãÂà∞ÁöÑÊñá‰ª∂ÁõÆÂΩïÂ∞±Ë¢´ÈöîÁ¶ªÂºÄ‰∫Ü„ÄÇÂêå chroot ‰∏çÂêåÔºåÊØè‰∏™ namespace ‰∏≠ÁöÑ container Âú® /proc/mounts ÁöÑ‰ø°ÊÅØÂè™ÂåÖÂê´ÊâÄÂú® namespace ÁöÑ mount point„ÄÇ</p>
<h3 id="net-namespace"><a class="header-anchor" href="#net-namespace"></a>net namespace</h3>
<p>ÁΩëÁªúÈöîÁ¶ªÊòØÈÄöËøá net namespace ÂÆûÁé∞ÁöÑÔºå ÊØè‰∏™ net namespace ÊúâÁã¨Á´ãÁöÑ network devices, IP addresses, IP routing tables, /proc/net ÁõÆÂΩï„ÄÇËøôÊ†∑ÊØè‰∏™ container ÁöÑÁΩëÁªúÂ∞±ËÉΩÈöîÁ¶ªÂºÄÊù•„ÄÇ docker ÈªòËÆ§ÈááÁî® veth ÁöÑÊñπÂºèÂ∞Ü container ‰∏≠ÁöÑËôöÊãüÁΩëÂç°Âêå host ‰∏äÁöÑ‰∏Ä‰∏™ docker bridge ËøûÊé•Âú®‰∏ÄËµ∑„ÄÇ</p>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="https://blog.jtlebi.fr/2014/01/19/introduction-to-linux-namespaces-part-5-net/">Introduction to Linux namespaces ‚Äì Part 5: NET</a></p>
<h3 id="uts-namespace"><a class="header-anchor" href="#uts-namespace"></a>uts namespace</h3>
<p>UTS (‚ÄúUNIX Time-sharing System‚Äù) namespace ÂÖÅËÆ∏ÊØè‰∏™ container Êã•ÊúâÁã¨Á´ãÁöÑ hostname Âíå domain name, ‰ΩøÂÖ∂Âú®ÁΩëÁªú‰∏äÂèØ‰ª•Ë¢´ËßÜ‰Ωú‰∏Ä‰∏™Áã¨Á´ãÁöÑËäÇÁÇπËÄåÈùû Host ‰∏äÁöÑ‰∏Ä‰∏™ËøõÁ®ã„ÄÇ</p>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="https://blog.jtlebi.fr/2013/12/22/introduction-to-linux-namespaces-part-1-uts/">Introduction to Linux namespaces ‚Äì Part 1: UTS</a></p>
<h3 id="ipc-namespace"><a class="header-anchor" href="#ipc-namespace"></a>ipc namespace</h3>
<p>container ‰∏≠ËøõÁ®ã‰∫§‰∫íËøòÊòØÈááÁî® Linux Â∏∏ËßÅÁöÑËøõÁ®ãÈó¥‰∫§‰∫íÊñπÊ≥ï (interprocess communication - IPC), ÂåÖÊã¨Â∏∏ËßÅÁöÑ‰ø°Âè∑Èáè„ÄÅÊ∂àÊÅØÈòüÂàóÂíåÂÖ±‰∫´ÂÜÖÂ≠ò„ÄÇÁÑ∂ËÄåÂêå VM ‰∏çÂêåÔºåcontainer ÁöÑËøõÁ®ãÈó¥‰∫§‰∫íÂÆûÈôÖ‰∏äËøòÊòØ host ‰∏äÂÖ∑ÊúâÁõ∏Âêå pid namespace ‰∏≠ÁöÑËøõÁ®ãÈó¥‰∫§‰∫íÔºåÂõ†Ê≠§ÈúÄË¶ÅÂú®IPCËµÑÊ∫êÁî≥ËØ∑Êó∂Âä†ÂÖ• namespace ‰ø°ÊÅØ - ÊØè‰∏™ IPC ËµÑÊ∫êÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑ 32bit ID„ÄÇ</p>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="https://blog.jtlebi.fr/2013/12/28/introduction-to-linux-namespaces-part-2-ipc/">Introduction to Linux namespaces ‚Äì Part 2: IPC</a></p>
<h3 id="user-namespace"><a class="header-anchor" href="#user-namespace"></a>user namespace</h3>
<p>ÊØè‰∏™ container ÂèØ‰ª•Êúâ‰∏çÂêåÁöÑ user Âíå group id, ‰πüÂ∞±ÊòØËØ¥ÂèØ‰ª•‰ª• container ÂÜÖÈÉ®ÁöÑÁî®Êà∑Âú® container ÂÜÖÈÉ®ÊâßË°åÁ®ãÂ∫èËÄåÈùû Host ‰∏äÁöÑÁî®Êà∑„ÄÇ</p>
<p>Êúâ‰∫Ü‰ª•‰∏ä 6 Áßç namespace ‰ªéËøõÁ®ã„ÄÅÁΩëÁªú„ÄÅIPC„ÄÅÊñá‰ª∂Á≥ªÁªü„ÄÅUTS ÂíåÁî®Êà∑ËßíÂ∫¶ÁöÑÈöîÁ¶ªÔºå‰∏Ä‰∏™ container Â∞±ÂèØ‰ª•ÂØπÂ§ñÂ±ïÁé∞Âá∫‰∏Ä‰∏™Áã¨Á´ãËÆ°ÁÆóÊú∫ÁöÑËÉΩÂäõÔºåÂπ∂‰∏î‰∏çÂêå container ‰ªé OS Â±ÇÈù¢ÂÆûÁé∞‰∫ÜÈöîÁ¶ª„ÄÇ ÁÑ∂ËÄå‰∏çÂêå namespace ‰πãÈó¥ËµÑÊ∫êËøòÊòØÁõ∏‰∫íÁ´û‰∫âÁöÑÔºå‰ªçÁÑ∂ÈúÄË¶ÅÁ±ª‰ºº ulimit Êù•ÁÆ°ÁêÜÊØè‰∏™ container ÊâÄËÉΩ‰ΩøÁî®ÁöÑËµÑÊ∫ê - cgroup„ÄÇ</p>
<h3 id="Reference"><a class="header-anchor" href="#Reference"></a>Reference</h3>
<ul>
<li><a target="_blank" rel="noopener" href="http://tiewei.github.io/cloud/Docker-Getting-Start/">Docker Getting Start: Related Knowledge</a></li>
<li><a target="_blank" rel="noopener" href="https://ruby-china.org/topics/22004">Docker ‰ªãÁªç‰ª•ÂèäÂÖ∂Áõ∏ÂÖ≥ÊúØËØ≠„ÄÅÂ∫ïÂ±ÇÂéüÁêÜÂíåÊäÄÊúØ</a></li>
</ul>
<h2 id="1-6-ËµÑÊ∫êÈÖçÈ¢ù„Äåcgroups„Äç"><a class="header-anchor" href="#1-6-ËµÑÊ∫êÈÖçÈ¢ù„Äåcgroups„Äç"></a>1.6 ËµÑÊ∫êÈÖçÈ¢ù„Äåcgroups„Äç</h2>
<p>cgroups ÂÆûÁé∞‰∫ÜÂØπËµÑÊ∫êÁöÑÈÖçÈ¢ùÂíåÂ∫¶Èáè„ÄÇ cgroups ÁöÑ‰ΩøÁî®ÈùûÂ∏∏ÁÆÄÂçïÔºåÊèê‰æõÁ±ª‰ººÊñá‰ª∂ÁöÑÊé•Âè£ÔºåÂú® /cgroup ÁõÆÂΩï‰∏ãÊñ∞Âª∫‰∏Ä‰∏™Êñá‰ª∂Â§πÂç≥ÂèØÊñ∞Âª∫‰∏Ä‰∏™ groupÔºåÂú®Ê≠§Êñá‰ª∂Â§π‰∏≠Êñ∞Âª∫ task Êñá‰ª∂ÔºåÂπ∂Â∞Ü pid ÂÜôÂÖ•ËØ•Êñá‰ª∂ÔºåÂç≥ÂèØÂÆûÁé∞ÂØπËØ•ËøõÁ®ãÁöÑËµÑÊ∫êÊéßÂà∂„ÄÇÂÖ∑‰ΩìÁöÑËµÑÊ∫êÈÖçÁΩÆÈÄâÈ°πÂèØ‰ª•Âú®ËØ•Êñá‰ª∂Â§π‰∏≠Êñ∞Âª∫Â≠ê subsystem Ôºå{Â≠êÁ≥ªÁªüÂâçÁºÄ}.{ËµÑÊ∫êÈ°π} ÊòØÂÖ∏ÂûãÁöÑÈÖçÁΩÆÊñπÊ≥ïÔºå Â¶Ç memory.usageinbytes Â∞±ÂÆö‰πâ‰∫ÜËØ• group Âú® subsystem memory ‰∏≠ÁöÑ‰∏Ä‰∏™ÂÜÖÂ≠òÈôêÂà∂ÈÄâÈ°π„ÄÇ Âè¶Â§ñÔºåcgroups ‰∏≠ÁöÑ subsystem ÂèØ‰ª•ÈöèÊÑèÁªÑÂêàÔºå‰∏Ä‰∏™ subsystem ÂèØ‰ª•Âú®‰∏çÂêåÁöÑ group ‰∏≠Ôºå‰πüÂèØ‰ª•‰∏Ä‰∏™ group ÂåÖÂê´Â§ö‰∏™ subsystem - ‰πüÂ∞±ÊòØËØ¥‰∏Ä‰∏™ subsystem„ÄÇ</p>
<ul>
<li>memory
<ul>
<li>ÂÜÖÂ≠òÁõ∏ÂÖ≥ÁöÑÈôêÂà∂</li>
</ul>
</li>
<li>cpu
<ul>
<li>Âú® cgroup ‰∏≠ÔºåÂπ∂‰∏çËÉΩÂÉèÁ°¨‰ª∂ËôöÊãüÂåñÊñπÊ°à‰∏ÄÊ†∑ËÉΩÂ§üÂÆö‰πâ CPU ËÉΩÂäõÔºå‰ΩÜÊòØËÉΩÂ§üÂÆö‰πâ CPU ËΩÆËΩ¨ÁöÑ‰ºòÂÖàÁ∫ßÔºåÂõ†Ê≠§ÂÖ∑ÊúâËæÉÈ´ò CPU ‰ºòÂÖàÁ∫ßÁöÑËøõÁ®ã‰ºöÊõ¥ÂèØËÉΩÂæóÂà∞ CPU ËøêÁÆó„ÄÇ ÈÄöËøáÂ∞ÜÂèÇÊï∞ÂÜôÂÖ• cpu.shares ,Âç≥ÂèØÂÆö‰πâÊîπ cgroup ÁöÑ CPU ‰ºòÂÖàÁ∫ß - ËøôÈáåÊòØ‰∏Ä‰∏™Áõ∏ÂØπÊùÉÈáçÔºåËÄåÈùûÁªùÂØπÂÄº</li>
</ul>
</li>
<li>blkio
<ul>
<li>block IO Áõ∏ÂÖ≥ÁöÑÁªüËÆ°ÂíåÈôêÂà∂Ôºåbyte/operation ÁªüËÆ°ÂíåÈôêÂà∂ (IOPS Á≠â)ÔºåËØªÂÜôÈÄüÂ∫¶ÈôêÂà∂Á≠âÔºå‰ΩÜÊòØËøôÈáå‰∏ªË¶ÅÁªüËÆ°ÁöÑÈÉΩÊòØÂêåÊ≠• IO</li>
</ul>
</li>
<li>devices
<ul>
<li>ËÆæÂ§áÊùÉÈôêÈôêÂà∂</li>
</ul>
</li>
</ul>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="http://tiewei.github.io/devops/howto-use-cgroup/">how to use cgroup</a></p>
<h1 id="‰∫å„ÄÅDocker-ÂÆâË£Ö"><a class="header-anchor" href="#‰∫å„ÄÅDocker-ÂÆâË£Ö"></a>‰∫å„ÄÅDocker ÂÆâË£Ö</h1>
<p>docker ÁöÑÁõ∏ÂÖ≥ÂÆâË£ÖÊñπÊ≥ïËøôÈáå‰∏ç‰Ωú‰ªãÁªçÔºåÂÖ∑‰ΩìÂÆâË£ÖÂèÇËÄÉ¬†<a target="_blank" rel="noopener" href="https://docs.docker.com/installation/">ÂÆòÊ°£</a></p>
<p>Ëé∑ÂèñÂΩìÂâç docker ÁâàÊú¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker version<br>Client version: 1.3.2<br>Client API version: 1.15<br>Go version (client): go1.3.3<br>Git commit (client): 39fa2fa/1.3.2<br>OS/Arch (client): linux/amd64<br>Server version: 1.3.2<br>Server API version: 1.15<br>Go version (server): go1.3.3<br>Git commit (server): 39fa2fa/1.3.2<br></code></pre></td></tr></table></figure>
<h1 id="‰∏â„ÄÅDocker-Âü∫Á°ÄÁî®Ê≥ï"><a class="header-anchor" href="#‰∏â„ÄÅDocker-Âü∫Á°ÄÁî®Ê≥ï"></a>‰∏â„ÄÅDocker Âü∫Á°ÄÁî®Ê≥ï</h1>
<p><a target="_blank" rel="noopener" href="https://registry.hub.docker.com/">Docker HUB</a>¬†: DockerÈïúÂÉèÈ¶ñÈ°µÔºåÂåÖÊã¨ÂÆòÊñπÈïúÂÉèÂíåÂÖ∂ÂÆÉÂÖ¨ÂºÄÈïúÂÉè</p>
<p>Âõ†‰∏∫ÂõΩÊÉÖÁöÑÂéüÂõ†ÔºåÂõΩÂÜÖ‰∏ãËΩΩ Docker HUB ÂÆòÊñπÁöÑÁõ∏ÂÖ≥ÈïúÂÉèÊØîËæÉÊÖ¢ÔºåÂèØ‰ª•‰ΩøÁî®¬†<a target="_blank" rel="noopener" href="http://opskumu.github.io/docker.cn">docker.cn</a>¬†ÈïúÂÉèÔºåÈïúÂÉè‰øùÊåÅÂíåÂÆòÊñπ‰∏ÄËá¥ÔºåÂÖ≥ÈîÆÊòØÈÄüÂ∫¶ÂùóÔºåÊé®Ëçê‰ΩøÁî®„ÄÇ</p>
<h2 id="3-1-Search-images"><a class="header-anchor" href="#3-1-Search-images"></a>3.1 Search images</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker search ubuntu<br></code></pre></td></tr></table></figure>
<h2 id="3-2-Pull-images"><a class="header-anchor" href="#3-2-Pull-images"></a>3.2 Pull images</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker pull ubuntu <span class="hljs-comment"># Ëé∑Âèñ ubuntu ÂÆòÊñπÈïúÂÉè </span><br>$ sudo docker images <span class="hljs-comment"># Êü•ÁúãÂΩìÂâçÈïúÂÉèÂàóË°® </span><br></code></pre></td></tr></table></figure>
<h2 id="3-3-Running-an-interactive-shell"><a class="header-anchor" href="#3-3-Running-an-interactive-shell"></a>3.3 Running an interactive shell</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -i -t ubuntu:14.04 /bin/bash<br></code></pre></td></tr></table></figure>
<ul>
<li>docker run - ËøêË°å‰∏Ä‰∏™ÂÆπÂô®</li>
<li>-t - ÂàÜÈÖç‰∏Ä‰∏™Ôºà‰º™Ôºâtty (link is external)</li>
<li>-i - ‰∫§‰∫íÊ®°Âºè (so we can interact with it)</li>
<li>ubuntu:14.04 - ‰ΩøÁî® ubuntu Âü∫Á°ÄÈïúÂÉè 14.04</li>
<li>/bin/bash - ËøêË°åÂëΩ‰ª§ bash shell</li>
</ul>
<p>Ê≥®: ubuntu ‰ºöÊúâÂ§ö‰∏™ÁâàÊú¨ÔºåÈÄöËøáÊåáÂÆö tag Êù•ÂêØÂä®ÁâπÂÆöÁöÑÁâàÊú¨ [image]:[tag]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker ps <span class="hljs-comment"># Êü•ÁúãÂΩìÂâçËøêË°åÁöÑÂÆπÂô®, ps -a ÂàóÂá∫ÂΩìÂâçÁ≥ªÁªüÊâÄÊúâÁöÑÂÆπÂô® </span><br>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES<br>6c9129e9df10        ubuntu:14.04        /bin/bash 6 minutes ago       Up 6 minutes                            cranky_babbage<br></code></pre></td></tr></table></figure>
<h2 id="3-4-Áõ∏ÂÖ≥Âø´Êç∑ÈîÆ"><a class="header-anchor" href="#3-4-Áõ∏ÂÖ≥Âø´Êç∑ÈîÆ"></a>3.4 Áõ∏ÂÖ≥Âø´Êç∑ÈîÆ</h2>
<ul>
<li>ÈÄÄÂá∫ÔºöCtrl-Dorexit</li>
<li>detachÔºöCtrl-P + Ctrl-Q</li>
<li>attach:docker attach CONTAINER-ID</li>
</ul>
<h1 id="Âõõ„ÄÅDocker-ÂëΩ‰ª§Â∏ÆÂä©"><a class="header-anchor" href="#Âõõ„ÄÅDocker-ÂëΩ‰ª§Â∏ÆÂä©"></a>Âõõ„ÄÅDocker ÂëΩ‰ª§Â∏ÆÂä©</h1>
<h2 id="4-1-docker-help"><a class="header-anchor" href="#4-1-docker-help"></a>4.1 docker help</h2>
<h3 id="docker-command"><a class="header-anchor" href="#docker-command"></a>docker command</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker   <span class="hljs-comment"># docker ÂëΩ‰ª§Â∏ÆÂä©</span><br>Commands:<br>    attach    Attach to a running container                 <span class="hljs-comment"># ÂΩìÂâç shell ‰∏ã attach ËøûÊé•ÊåáÂÆöËøêË°åÈïúÂÉè</span><br>    build     Build an image from a Dockerfile              <span class="hljs-comment"># ÈÄöËøá Dockerfile ÂÆöÂà∂ÈïúÂÉè</span><br>    commit    Create a new image from a container<span class="hljs-string">&#x27;s changes # Êèê‰∫§ÂΩìÂâçÂÆπÂô®‰∏∫Êñ∞ÁöÑÈïúÂÉè</span><br><span class="hljs-string">    cp        Copy files/folders from the containers filesystem to the host path</span><br><span class="hljs-string">              # ‰ªéÂÆπÂô®‰∏≠Êã∑Ë¥ùÊåáÂÆöÊñá‰ª∂ÊàñËÄÖÁõÆÂΩïÂà∞ÂÆø‰∏ªÊú∫‰∏≠</span><br><span class="hljs-string">    create    Create a new container                        # ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆπÂô®ÔºåÂêå runÔºå‰ΩÜ‰∏çÂêØÂä®ÂÆπÂô®</span><br><span class="hljs-string">    diff      Inspect changes on a container&#x27;</span>s filesystem   <span class="hljs-comment"># Êü•Áúã docker ÂÆπÂô®ÂèòÂåñ</span><br>    events    Get real time events from the server          <span class="hljs-comment"># ‰ªé docker ÊúçÂä°Ëé∑ÂèñÂÆπÂô®ÂÆûÊó∂‰∫ã‰ª∂</span><br>    <span class="hljs-built_in">exec</span>      Run a <span class="hljs-built_in">command</span> <span class="hljs-keyword">in</span> an existing container        <span class="hljs-comment"># Âú®Â∑≤Â≠òÂú®ÁöÑÂÆπÂô®‰∏äËøêË°åÂëΩ‰ª§</span><br>    <span class="hljs-built_in">export</span>    Stream the contents of a container as a tar archive   <br>              <span class="hljs-comment"># ÂØºÂá∫ÂÆπÂô®ÁöÑÂÜÖÂÆπÊµÅ‰Ωú‰∏∫‰∏Ä‰∏™ tar ÂΩíÊ°£Êñá‰ª∂[ÂØπÂ∫î import ]</span><br>    <span class="hljs-built_in">history</span>   Show the <span class="hljs-built_in">history</span> of an image                  <span class="hljs-comment"># Â±ïÁ§∫‰∏Ä‰∏™ÈïúÂÉèÂΩ¢ÊàêÂéÜÂè≤</span><br>    images    List images                                   <span class="hljs-comment"># ÂàóÂá∫Á≥ªÁªüÂΩìÂâçÈïúÂÉè</span><br>    import    Create a new filesystem image from the contents of a tarball  <br>              <span class="hljs-comment"># ‰ªétarÂåÖ‰∏≠ÁöÑÂÜÖÂÆπÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÊñá‰ª∂Á≥ªÁªüÊò†ÂÉè[ÂØπÂ∫î export]</span><br>    info      Display system-wide information               <span class="hljs-comment"># ÊòæÁ§∫Á≥ªÁªüÁõ∏ÂÖ≥‰ø°ÊÅØ</span><br>    inspect   Return low-level information on a container   <span class="hljs-comment"># Êü•ÁúãÂÆπÂô®ËØ¶ÁªÜ‰ø°ÊÅØ</span><br>    <span class="hljs-built_in">kill</span>      Kill a running container                      <span class="hljs-comment"># kill ÊåáÂÆö docker ÂÆπÂô®</span><br>    load      Load an image from a tar archive              <span class="hljs-comment"># ‰ªé‰∏Ä‰∏™ tar ÂåÖ‰∏≠Âä†ËΩΩ‰∏Ä‰∏™ÈïúÂÉè[ÂØπÂ∫î save]</span><br>    login     Register or Login to the docker registry server   <br>              <span class="hljs-comment"># Ê≥®ÂÜåÊàñËÄÖÁôªÈôÜ‰∏Ä‰∏™ docker Ê∫êÊúçÂä°Âô®</span><br>    <span class="hljs-built_in">logout</span>    Log out from a Docker registry server         <span class="hljs-comment"># ‰ªéÂΩìÂâç Docker registry ÈÄÄÂá∫</span><br>    logs      Fetch the logs of a container                 <span class="hljs-comment"># ËæìÂá∫ÂΩìÂâçÂÆπÂô®Êó•Âøó‰ø°ÊÅØ</span><br>    port      Lookup the public-facing port <span class="hljs-built_in">which</span> is NAT-ed to PRIVATE_PORT<br>              <span class="hljs-comment"># Êü•ÁúãÊò†Â∞ÑÁ´ØÂè£ÂØπÂ∫îÁöÑÂÆπÂô®ÂÜÖÈÉ®Ê∫êÁ´ØÂè£</span><br>    pause     Pause all processes within a container        <span class="hljs-comment"># ÊöÇÂÅúÂÆπÂô®</span><br>    ps        List containers                               <span class="hljs-comment"># ÂàóÂá∫ÂÆπÂô®ÂàóË°®</span><br>    pull      Pull an image or a repository from the docker registry server<br>              <span class="hljs-comment"># ‰ªédockerÈïúÂÉèÊ∫êÊúçÂä°Âô®ÊãâÂèñÊåáÂÆöÈïúÂÉèÊàñËÄÖÂ∫ìÈïúÂÉè</span><br>    push      Push an image or a repository to the docker registry server<br>              <span class="hljs-comment"># Êé®ÈÄÅÊåáÂÆöÈïúÂÉèÊàñËÄÖÂ∫ìÈïúÂÉèËá≥dockerÊ∫êÊúçÂä°Âô®</span><br>    restart   Restart a running container                   <span class="hljs-comment"># ÈáçÂêØËøêË°åÁöÑÂÆπÂô®</span><br>    <span class="hljs-built_in">rm</span>        Remove one or more containers                 <span class="hljs-comment"># ÁßªÈô§‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™ÂÆπÂô®</span><br>    rmi       Remove one or more images                 <br>              <span class="hljs-comment"># ÁßªÈô§‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÈïúÂÉè[Êó†ÂÆπÂô®‰ΩøÁî®ËØ•ÈïúÂÉèÊâçÂèØÂà†Èô§ÔºåÂê¶ÂàôÈúÄÂà†Èô§Áõ∏ÂÖ≥ÂÆπÂô®ÊâçÂèØÁªßÁª≠Êàñ -f Âº∫Âà∂Âà†Èô§]</span><br>    run       Run a <span class="hljs-built_in">command</span> <span class="hljs-keyword">in</span> a new container<br>              <span class="hljs-comment"># ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆπÂô®Âπ∂ËøêË°å‰∏Ä‰∏™ÂëΩ‰ª§</span><br>    save      Save an image to a tar archive                <span class="hljs-comment"># ‰øùÂ≠ò‰∏Ä‰∏™ÈïúÂÉè‰∏∫‰∏Ä‰∏™ tar ÂåÖ[ÂØπÂ∫î load]</span><br>    search    Search <span class="hljs-keyword">for</span> an image on the Docker Hub         <span class="hljs-comment"># Âú® docker hub ‰∏≠ÊêúÁ¥¢ÈïúÂÉè</span><br>    start     Start a stopped containers                    <span class="hljs-comment"># ÂêØÂä®ÂÆπÂô®</span><br>    stop      Stop a running containers                     <span class="hljs-comment"># ÂÅúÊ≠¢ÂÆπÂô®</span><br>    tag       Tag an image into a repository                <span class="hljs-comment"># ÁªôÊ∫ê‰∏≠ÈïúÂÉèÊâìÊ†áÁ≠æ</span><br>    top       Lookup the running processes of a container   <span class="hljs-comment"># Êü•ÁúãÂÆπÂô®‰∏≠ËøêË°åÁöÑËøõÁ®ã‰ø°ÊÅØ</span><br>    unpause   Unpause a paused container                    <span class="hljs-comment"># ÂèñÊ∂àÊöÇÂÅúÂÆπÂô®</span><br>    version   Show the docker version information           <span class="hljs-comment"># Êü•Áúã docker ÁâàÊú¨Âè∑</span><br>    <span class="hljs-built_in">wait</span>      Block until a container stops, <span class="hljs-keyword">then</span> <span class="hljs-built_in">print</span> its <span class="hljs-built_in">exit</span> code   <br>              <span class="hljs-comment"># Êà™ÂèñÂÆπÂô®ÂÅúÊ≠¢Êó∂ÁöÑÈÄÄÂá∫Áä∂ÊÄÅÂÄº</span><br>Run <span class="hljs-string">&#x27;docker COMMAND --help&#x27;</span> <span class="hljs-keyword">for</span> more information on a <span class="hljs-built_in">command</span>.<br></code></pre></td></tr></table></figure>
<h3 id="docker-option"><a class="header-anchor" href="#docker-option"></a>docker option</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">Usage of docker:<br>  --api-enable-cors=<span class="hljs-literal">false</span>                Enable CORS headers <span class="hljs-keyword">in</span> the remote API                      <span class="hljs-comment"># ËøúÁ®ã API ‰∏≠ÂºÄÂêØ CORS Â§¥</span><br>  -b, --bridge=<span class="hljs-string">&quot;&quot;</span>                        Attach containers to a pre-existing network bridge         <span class="hljs-comment"># Ê°•Êé•ÁΩëÁªú</span><br>                                           use <span class="hljs-string">&#x27;none&#x27;</span> to <span class="hljs-built_in">disable</span> container networking<br>  --bip=<span class="hljs-string">&quot;&quot;</span>                               Use this CIDR notation address <span class="hljs-keyword">for</span> the network bridge<span class="hljs-string">&#x27;s IP, not compatible with -b</span><br><span class="hljs-string">                                         # Âíå -b ÈÄâÈ°π‰∏çÂÖºÂÆπÔºåÂÖ∑‰ΩìÊ≤°ÊúâÊµãËØïËøá</span><br><span class="hljs-string">  -d, --daemon=false                     Enable daemon mode                                         # daemon Ê®°Âºè</span><br><span class="hljs-string">  -D, --debug=false                      Enable debug mode                                          # debug Ê®°Âºè</span><br><span class="hljs-string">  --dns=[]                               Force docker to use specific DNS servers                   # Âº∫Âà∂ docker ‰ΩøÁî®ÊåáÂÆö dns ÊúçÂä°Âô®</span><br><span class="hljs-string">  --dns-search=[]                        Force Docker to use specific DNS search domains            # Âº∫Âà∂ docker ‰ΩøÁî®ÊåáÂÆö dns ÊêúÁ¥¢Âüü</span><br><span class="hljs-string">  -e, --exec-driver=&quot;native&quot;             Force the docker runtime to use a specific exec driver     # Âº∫Âà∂ docker ËøêË°åÊó∂‰ΩøÁî®ÊåáÂÆöÊâßË°åÈ©±Âä®Âô®</span><br><span class="hljs-string">  --fixed-cidr=&quot;&quot;                        IPv4 subnet for fixed IPs (ex: 10.20.0.0/16)</span><br><span class="hljs-string">                                           this subnet must be nested in the bridge subnet (which is defined by -b or --bip)</span><br><span class="hljs-string">  -G, --group=&quot;docker&quot;                   Group to assign the unix socket specified by -H when running in daemon mode</span><br><span class="hljs-string">                                           use &#x27;</span><span class="hljs-string">&#x27; (the empty string) to disable setting of a group</span><br><span class="hljs-string">  -g, --graph=&quot;/var/lib/docker&quot;          Path to use as the root of the docker runtime              # ÂÆπÂô®ËøêË°åÁöÑÊ†πÁõÆÂΩïË∑ØÂæÑ</span><br><span class="hljs-string">  -H, --host=[]                          The socket(s) to bind to in daemon mode                    # daemon Ê®°Âºè‰∏ã docker ÊåáÂÆöÁªëÂÆöÊñπÂºè[tcp or Êú¨Âú∞ socket]</span><br><span class="hljs-string">                                           specified using one or more tcp://host:port, unix:///path/to/socket, fd://* or fd://socketfd.</span><br><span class="hljs-string">  --icc=true                             Enable inter-container communication                       # Ë∑®ÂÆπÂô®ÈÄö‰ø°</span><br><span class="hljs-string">  --insecure-registry=[]                 Enable insecure communication with specified registries (no certificate verification for HTTPS and enable HTTP fallback) (e.g., localhost:5000 or 10.20.0.0/16)</span><br><span class="hljs-string">  --ip=&quot;0.0.0.0&quot;                         Default IP address to use when binding container ports     # ÊåáÂÆöÁõëÂê¨Âú∞ÂùÄÔºåÈªòËÆ§ÊâÄÊúâ ip</span><br><span class="hljs-string">  --ip-forward=true                      Enable net.ipv4.ip_forward                                 # ÂºÄÂêØËΩ¨Âèë</span><br><span class="hljs-string">  --ip-masq=true                         Enable IP masquerading for bridge&#x27;</span>s IP range<br>  --iptables=<span class="hljs-literal">true</span>                        Enable Docker<span class="hljs-string">&#x27;s addition of iptables rules                 # Ê∑ªÂä†ÂØπÂ∫î iptables ËßÑÂàô</span><br><span class="hljs-string">  --mtu=0                                Set the containers network MTU                             # ËÆæÁΩÆÁΩëÁªú mtu</span><br><span class="hljs-string">                                           if no value is provided: default to the default route MTU or 1500 if no default route is available</span><br><span class="hljs-string">  -p, --pidfile=&quot;/var/run/docker.pid&quot;    Path to use for daemon PID file                            # ÊåáÂÆö pid Êñá‰ª∂‰ΩçÁΩÆ</span><br><span class="hljs-string">  --registry-mirror=[]                   Specify a preferred Docker registry mirror                  </span><br><span class="hljs-string">  -s, --storage-driver=&quot;&quot;                Force the docker runtime to use a specific storage driver  # Âº∫Âà∂ docker ËøêË°åÊó∂‰ΩøÁî®ÊåáÂÆöÂ≠òÂÇ®È©±Âä®</span><br><span class="hljs-string">  --selinux-enabled=false                Enable selinux support                                     # ÂºÄÂêØ selinux ÊîØÊåÅ</span><br><span class="hljs-string">  --storage-opt=[]                       Set storage driver options                                 # ËÆæÁΩÆÂ≠òÂÇ®È©±Âä®ÈÄâÈ°π</span><br><span class="hljs-string">  --tls=false                            Use TLS; implied by tls-verify flags                       # ÂºÄÂêØ tls</span><br><span class="hljs-string">  --tlscacert=&quot;/root/.docker/ca.pem&quot;     Trust only remotes providing a certificate signed by the CA given here</span><br><span class="hljs-string">  --tlscert=&quot;/root/.docker/cert.pem&quot;     Path to TLS certificate file                               # tls ËØÅ‰π¶Êñá‰ª∂‰ΩçÁΩÆ</span><br><span class="hljs-string">  --tlskey=&quot;/root/.docker/key.pem&quot;       Path to TLS key file                                       # tls key Êñá‰ª∂‰ΩçÁΩÆ</span><br><span class="hljs-string">  --tlsverify=false                      Use TLS and verify the remote (daemon: verify client, client: verify daemon) # ‰ΩøÁî® tls Âπ∂Á°ÆËÆ§ËøúÁ®ãÊéßÂà∂‰∏ªÊú∫</span><br><span class="hljs-string">  -v, --version=false                    Print version information and quit                         # ËæìÂá∫ docker ÁâàÊú¨‰ø°ÊÅØ</span><br></code></pre></td></tr></table></figure>
<h2 id="4-2-docker-search"><a class="header-anchor" href="#4-2-docker-search"></a>4.2 docker search</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker search --<span class="hljs-built_in">help</span><br>Usage: docker search TERM<br>Search the Docker Hub <span class="hljs-keyword">for</span> images <span class="hljs-comment"># ‰ªé Docker Hub ÊêúÁ¥¢ÈïúÂÉè --automated=false Only show automated builds</span><br>  --no-trunc=<span class="hljs-literal">false</span> Don<span class="hljs-string">&#x27;t truncate output</span><br><span class="hljs-string">  -s, --stars=0 Only displays with at least xxx stars</span><br></code></pre></td></tr></table></figure>
<p>Á§∫‰æãÔºö</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">$ sudo docker <span class="hljs-keyword">search</span> -s <span class="hljs-number">100</span> ubuntu # Êü•Êâæ star Êï∞Ëá≥Â∞ë‰∏∫ <span class="hljs-number">100</span> ÁöÑÈïúÂÉèÔºåÊâæÂá∫Âè™ÊúâÂÆòÊñπÈïúÂÉè <span class="hljs-keyword">start</span> Êï∞Ë∂ÖËøá <span class="hljs-number">100</span>ÔºåÈªòËÆ§‰∏çÂä† s ÈÄâÈ°πÊâæÂá∫ÊâÄÊúâÁõ∏ÂÖ≥ ubuntu ÈïúÂÉè <br><span class="hljs-type">NAME</span>      DESCRIPTION                  STARS     OFFICIAL   AUTOMATED<br>ubuntu    Official Ubuntu base image <span class="hljs-number">425</span> [OK] <br></code></pre></td></tr></table></figure>
<h2 id="4-3-docker-info"><a class="header-anchor" href="#4-3-docker-info"></a>4.3 docker info</h2>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">$</span> <span class="hljs-string">sudo</span> <span class="hljs-string">docker</span> <span class="hljs-string">info</span> <br><span class="hljs-attr">Containers:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># ÂÆπÂô®‰∏™Êï∞ </span><br><span class="hljs-attr">Images:</span> <span class="hljs-number">22</span> <span class="hljs-comment"># ÈïúÂÉè‰∏™Êï∞ </span><br><span class="hljs-attr">Storage Driver:</span> <span class="hljs-string">devicemapper</span> <span class="hljs-comment"># Â≠òÂÇ®È©±Âä® </span><br><span class="hljs-attr">Pool Name:</span> <span class="hljs-string">docker-8:17-3221225728-pool</span><br><span class="hljs-attr">Pool Blocksize:</span> <span class="hljs-number">65.54</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Data file:</span> <span class="hljs-string">/data/docker/devicemapper/devicemapper/data</span><br><span class="hljs-attr">Metadata file:</span> <span class="hljs-string">/data/docker/devicemapper/devicemapper/metadata</span><br><span class="hljs-attr">Data Space Used:</span> <span class="hljs-number">1.83</span> <span class="hljs-string">GB</span><br> <span class="hljs-attr">Data Space Total:</span> <span class="hljs-number">107.4</span> <span class="hljs-string">GB</span><br><span class="hljs-attr">Metadata Space Used:</span> <span class="hljs-number">2.191</span> <span class="hljs-string">MB</span><br> <span class="hljs-attr">Metadata Space Total:</span> <span class="hljs-number">2.147</span> <span class="hljs-string">GB</span><br><span class="hljs-attr">Library Version:</span> <span class="hljs-number">1.02</span><span class="hljs-number">.84</span><span class="hljs-string">-RHEL7</span> <span class="hljs-string">(2014-03-26)</span> <span class="hljs-attr">Execution Driver:</span> <span class="hljs-string">native-0.2</span> <span class="hljs-comment"># Â≠òÂÇ®È©±Âä® Kernel Version: 3.10.0-123.el7.x86_64</span><br><span class="hljs-attr">Operating System:</span> <span class="hljs-string">CentOS</span> <span class="hljs-string">Linux</span> <span class="hljs-number">7</span> <span class="hljs-string">(Core)</span> <br></code></pre></td></tr></table></figure>
<h2 id="4-4-docker-pull-docker-push"><a class="header-anchor" href="#4-4-docker-pull-docker-push"></a>4.4 docker pull &amp;&amp; docker push</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker pull --<span class="hljs-built_in">help</span> <span class="hljs-comment"># pull ÊãâÂèñÈïúÂÉè </span><br>Usage: docker pull [OPTIONS] NAME[:TAG] Pull an image or a repository from the registry<br>-a, --all-tags=<span class="hljs-literal">false</span> Download all tagged images <span class="hljs-keyword">in</span> the repository <br><br>$ sudo docker push <span class="hljs-comment"># push Êé®ÈÄÅÊåáÂÆöÈïúÂÉè </span><br>Usage: docker push NAME[:TAG] Push an image or a repository to the registry<br></code></pre></td></tr></table></figure>
<p>Á§∫‰æãÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker pull ubuntu <span class="hljs-comment"># ‰∏ãËΩΩÂÆòÊñπ ubuntu docker ÈïúÂÉèÔºåÈªòËÆ§‰∏ãËΩΩÊâÄÊúâ ubuntu ÂÆòÊñπÂ∫ìÈïúÂÉè </span><br>$ sudo docker pull ubuntu:14.04 <span class="hljs-comment"># ‰∏ãËΩΩÊåáÂÆöÁâàÊú¨ ubuntu ÂÆòÊñπÈïúÂÉè </span><br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker push 192.168.0.100:5000/ubuntu <span class="hljs-comment"># Êé®ÈÄÅÈïúÂÉèÂ∫ìÂà∞ÁßÅÊúâÊ∫ê[ÂèØÊ≥®ÂÜå docker ÂÆòÊñπË¥¶Êà∑ÔºåÊé®ÈÄÅÂà∞ÂÆòÊñπËá™ÊúâË¥¶Êà∑] </span><br>$ sudo docker push 192.168.0.100:5000/ubuntu:14.04 <span class="hljs-comment"># Êé®ÈÄÅÊåáÂÆöÈïúÂÉèÂà∞ÁßÅÊúâÊ∫ê </span><br></code></pre></td></tr></table></figure>
<h2 id="4-5-docker-images"><a class="header-anchor" href="#4-5-docker-images"></a>4.5 docker images</h2>
<p>ÂàóÂá∫ÂΩìÂâçÁ≥ªÁªüÈïúÂÉè</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker images --<span class="hljs-built_in">help</span><br><br>Usage: docker images [OPTIONS] [NAME] List images<br><br>  -a, --all=<span class="hljs-literal">false</span> Show all images (by default filter out the intermediate image layers) <span class="hljs-comment"># -a ÊòæÁ§∫ÂΩìÂâçÁ≥ªÁªüÁöÑÊâÄÊúâÈïúÂÉèÔºåÂåÖÊã¨ËøáÊ∏°Â±ÇÈïúÂÉèÔºåÈªòËÆ§ docker images ÊòæÁ§∫ÊúÄÁªàÈïúÂÉèÔºå‰∏çÂåÖÊã¨ËøáÊ∏°Â±ÇÈïúÂÉè </span><br>  -f, --filter=[] Provide filter values (i.e. <span class="hljs-string">&#x27;dangling=true&#x27;</span>) --no-trunc=<span class="hljs-literal">false</span> Don<span class="hljs-string">&#x27;t truncate output</span><br><span class="hljs-string">  -q, --quiet=false Only show numeric IDs</span><br></code></pre></td></tr></table></figure>
<p>Á§∫‰æãÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker images <span class="hljs-comment"># ÊòæÁ§∫ÂΩìÂâçÁ≥ªÁªüÈïúÂÉèÔºå‰∏çÂåÖÊã¨ËøáÊ∏°Â±ÇÈïúÂÉè </span><br>$ sudo docker images -a <span class="hljs-comment"># ÊòæÁ§∫ÂΩìÂâçÁ≥ªÁªüÊâÄÊúâÈïúÂÉèÔºåÂåÖÊã¨ËøáÊ∏°Â±ÇÈïúÂÉè </span><br>$ sudo docker images ubuntu <span class="hljs-comment"># ÊòæÁ§∫ÂΩìÂâçÁ≥ªÁªü docker ubuntu Â∫ì‰∏≠ÁöÑÊâÄÊúâÈïúÂÉè </span><br>REPOSITORY                 TAG                 IMAGE ID            CREATED             VIRTUAL SIZE<br>ubuntu                     12.04               ebe4be4dd427 4 weeks ago         210.6 MB<br>ubuntu                     14.04               e54ca5efa2e9 4 weeks ago         276.5 MB<br>ubuntu                     14.04-ssh           6334d3ac099a 7 weeks ago         383.2 MB<br></code></pre></td></tr></table></figure>
<h2 id="4-6-docker-rmi"><a class="header-anchor" href="#4-6-docker-rmi"></a>4.6 docker rmi</h2>
<p>Âà†Èô§‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™ÈïúÂÉè</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker rmi --<span class="hljs-built_in">help</span><br>Usage: docker rmi IMAGE [IMAGE...] Remove one or more images<br>  -f, --force=<span class="hljs-literal">false</span> Force removal of the image <span class="hljs-comment"># Âº∫Âà∂ÁßªÈô§ÈïúÂÉè‰∏çÁÆ°ÊòØÂê¶ÊúâÂÆπÂô®‰ΩøÁî®ËØ•ÈïúÂÉè --no-prune=false Do not delete untagged parents # ‰∏çË¶ÅÂà†Èô§Êú™Ê†áËÆ∞ÁöÑÁà∂ÈïúÂÉè </span><br></code></pre></td></tr></table></figure>
<h2 id="4-7-docker-run"><a class="header-anchor" href="#4-7-docker-run"></a>4.7 docker run</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --<span class="hljs-built_in">help</span><br>Usage: docker run [OPTIONS] IMAGE [COMMAND] [ARG...]<br>Run a <span class="hljs-built_in">command</span> <span class="hljs-keyword">in</span> a new container<br>  -a, --attach=[]            Attach to stdin, stdout or stderr.<br>  -c, --cpu-shares=0         CPU shares (relative weight)                       <span class="hljs-comment"># ËÆæÁΩÆ cpu ‰ΩøÁî®ÊùÉÈáç</span><br>  --cap-add=[]               Add Linux capabilities<br>  --cap-drop=[]              Drop Linux capabilities<br>  --cidfile=<span class="hljs-string">&quot;&quot;</span>               Write the container ID to the file                 <span class="hljs-comment"># ÊääÂÆπÂô® id ÂÜôÂÖ•Âà∞ÊåáÂÆöÊñá‰ª∂</span><br>  --cpuset=<span class="hljs-string">&quot;&quot;</span>                CPUs <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to allow execution (0-3, 0,1)        <span class="hljs-comment"># cpu ÁªëÂÆö</span><br>  -d, --detach=<span class="hljs-literal">false</span>         Detached mode: Run container <span class="hljs-keyword">in</span> the background, <span class="hljs-built_in">print</span> new container <span class="hljs-built_in">id</span> <span class="hljs-comment"># ÂêéÂè∞ËøêË°åÂÆπÂô®</span><br>  --device=[]                Add a host device to the container (e.g. --device=/dev/sdc:/dev/xvdc)<br>  --dns=[]                   Set custom dns servers                             <span class="hljs-comment"># ËÆæÁΩÆ dns</span><br>  --dns-search=[]            Set custom dns search domains                      <span class="hljs-comment"># ËÆæÁΩÆ dns ÂüüÊêúÁ¥¢</span><br>  -e, --<span class="hljs-built_in">env</span>=[]               Set environment variables                          <span class="hljs-comment"># ÂÆö‰πâÁéØÂ¢ÉÂèòÈáè</span><br>  --entrypoint=<span class="hljs-string">&quot;&quot;</span>            Overwrite the default entrypoint of the image      <span class="hljs-comment"># Ôºü</span><br>  --env-file=[]              Read <span class="hljs-keyword">in</span> a line delimited file of ENV variables     <span class="hljs-comment"># ‰ªéÊåáÂÆöÊñá‰ª∂ËØªÂèñÂèòÈáèÂÄº</span><br>  --expose=[]                Expose a port from the container without publishing it to your host    <span class="hljs-comment"># ÊåáÂÆöÂØπÂ§ñÊèê‰æõÊúçÂä°Á´ØÂè£</span><br>  -h, --hostname=<span class="hljs-string">&quot;&quot;</span>          Container host name                                <span class="hljs-comment"># ËÆæÁΩÆÂÆπÂô®‰∏ªÊú∫Âêç</span><br>  -i, --interactive=<span class="hljs-literal">false</span>    Keep stdin open even <span class="hljs-keyword">if</span> not attached               <span class="hljs-comment"># ‰øùÊåÅÊ†áÂáÜËæìÂá∫ÂºÄÂêØÂç≥‰ΩøÊ≤°Êúâ attached</span><br>  --<span class="hljs-built_in">link</span>=[]                  Add <span class="hljs-built_in">link</span> to another container (name:<span class="hljs-built_in">alias</span>)         <span class="hljs-comment"># Ê∑ªÂä†ÈìæÊé•Âà∞Âè¶Â§ñ‰∏Ä‰∏™ÂÆπÂô®</span><br>  --lxc-conf=[]              (lxc exec-driver only) Add custom lxc options --lxc-conf=<span class="hljs-string">&quot;lxc.cgroup.cpuset.cpus = 0,1&quot;</span><br>  -m, --memory=<span class="hljs-string">&quot;&quot;</span>            Memory <span class="hljs-built_in">limit</span> (format: &lt;number&gt;&lt;optional unit&gt;, <span class="hljs-built_in">where</span> unit = b, k, m or g) <span class="hljs-comment"># ÂÜÖÂ≠òÈôêÂà∂</span><br>  --name=<span class="hljs-string">&quot;&quot;</span>                  Assign a name to the container                     <span class="hljs-comment"># ËÆæÁΩÆÂÆπÂô®Âêç</span><br>  --net=<span class="hljs-string">&quot;bridge&quot;</span>             Set the Network mode <span class="hljs-keyword">for</span> the container             <span class="hljs-comment"># ËÆæÁΩÆÂÆπÂô®ÁΩëÁªúÊ®°Âºè</span><br>                               <span class="hljs-string">&#x27;bridge&#x27;</span>: creates a new network stack <span class="hljs-keyword">for</span> the container on the docker bridge<br>                               <span class="hljs-string">&#x27;none&#x27;</span>: no networking <span class="hljs-keyword">for</span> this container<br>                               <span class="hljs-string">&#x27;container:&lt;name|id&gt;&#x27;</span>: reuses another container network stack<br>                               <span class="hljs-string">&#x27;host&#x27;</span>: use the host network stack inside the container.  Note: the host mode gives the container full access to <span class="hljs-built_in">local</span> system services such as D-bus and is therefore considered insecure.<br>  -P, --publish-all=<span class="hljs-literal">false</span>    Publish all exposed ports to the host interfaces   <span class="hljs-comment"># Ëá™Âä®Êò†Â∞ÑÂÆπÂô®ÂØπÂ§ñÊèê‰æõÊúçÂä°ÁöÑÁ´ØÂè£</span><br>  -p, --publish=[]           Publish a container<span class="hljs-string">&#x27;s port to the host             # ÊåáÂÆöÁ´ØÂè£Êò†Â∞Ñ</span><br><span class="hljs-string">                               format: ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort</span><br><span class="hljs-string">                               (use &#x27;</span>docker port<span class="hljs-string">&#x27; to see the actual mapping)</span><br><span class="hljs-string">  --privileged=false         Give extended privileges to this container         # Êèê‰æõÊõ¥Â§öÁöÑÊùÉÈôêÁªôÂÆπÂô®</span><br><span class="hljs-string">  --restart=&quot;&quot;               Restart policy to apply when a container exits (no, on-failure[:max-retry], always)</span><br><span class="hljs-string">  --rm=false                 Automatically remove the container when it exits (incompatible with -d) # Â¶ÇÊûúÂÆπÂô®ÈÄÄÂá∫Ëá™Âä®ÁßªÈô§Âíå -d ÈÄâÈ°πÂÜ≤Á™Å</span><br><span class="hljs-string">  --security-opt=[]          Security Options</span><br><span class="hljs-string">  --sig-proxy=true           Proxify received signals to the process (even in non-tty mode). SIGCHLD is not proxied.</span><br><span class="hljs-string">  -t, --tty=false            Allocate a pseudo-tty                              # ÂàÜÈÖç‰º™ÁªàÁ´Ø</span><br><span class="hljs-string">  -u, --user=&quot;&quot;              Username or UID                                    # ÊåáÂÆöËøêË°åÂÆπÂô®ÁöÑÁî®Êà∑ uid ÊàñËÄÖÁî®Êà∑Âêç</span><br><span class="hljs-string">  -v, --volume=[]            Bind mount a volume (e.g., from the host: -v /host:/container, from docker: -v /container)</span><br><span class="hljs-string">                             # ÊåÇËΩΩÂç∑</span><br><span class="hljs-string">  --volumes-from=[]          Mount volumes from the specified container(s)      # ‰ªéÊåáÂÆöÂÆπÂô®ÊåÇËΩΩÂç∑</span><br><span class="hljs-string">  -w, --workdir=&quot;&quot;           Working directory inside the container             # ÊåáÂÆöÂÆπÂô®Â∑•‰ΩúÁõÆÂΩï</span><br></code></pre></td></tr></table></figure>
<p>Á§∫‰æãÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker images ubuntu<br>REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE<br>ubuntu              14.04               e54ca5efa2e9 4 weeks ago         276.5 MB<br>... ... <br>$ sudo docker run -t -i -c 100 -m 512MB -h test1 -d --name=<span class="hljs-string">&quot;docker_test1&quot;</span> ubuntu /bin/bash <br><span class="hljs-comment"># ÂàõÂª∫‰∏Ä‰∏™ cpu ‰ºòÂÖàÁ∫ß‰∏∫ 100ÔºåÂÜÖÂ≠òÈôêÂà∂ 512MBÔºå‰∏ªÊú∫Âêç‰∏∫ test1ÔºåÂêç‰∏∫ docker_test1 ÂêéÂè∞ËøêË°å bash ÁöÑÂÆπÂô® a424ca613c9f2247cd3ede95adfbaf8d28400cbcb1d5f9b69a7b56f97b2b52e5 </span><br>$ sudo docker ps <br>CONTAINER ID        IMAGE           COMMAND         CREATED             STATUS              PORTS       NAMES<br>a424ca613c9f        ubuntu:14.04    /bin/bash 6 seconds ago       Up 5 seconds                    docker_test1 <br>$ sudo docker attach docker_test1<br>root@test1:/<span class="hljs-comment"># pwd </span><br>/<br>root@test1:/<span class="hljs-comment"># exit </span><br><span class="hljs-built_in">exit</span> <br></code></pre></td></tr></table></figure>
<p>ÂÖ≥‰∫écpu‰ºòÂÖàÁ∫ß:</p>
<blockquote>
<p>By default all groups have 1024 shares. A group with 100 shares will get a ~10% portion of the CPU time -<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/cgroups">archlinux cgroups</a></p>
</blockquote>
<h2 id="4-8-docker-start-stop-kill‚Ä¶-‚Ä¶"><a class="header-anchor" href="#4-8-docker-start-stop-kill‚Ä¶-‚Ä¶"></a>4.8 docker start|stop|kill‚Ä¶ ‚Ä¶</h2>
<p>dockerstart|stop|kill|restart|pause|unpause|rm|commit|inspect|logs</p>
<ul>
<li>
<p>docker start CONTAINER [CONTAINER‚Ä¶]</p>
<ul>
<li># ËøêË°å‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÅúÊ≠¢ÁöÑÂÆπÂô®</li>
</ul>
</li>
<li>
<p>docker stop CONTAINER [CONTAINER‚Ä¶]</p>
<ul>
<li># ÂÅúÊéâ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËøêË°åÁöÑÂÆπÂô®-tÈÄâÈ°πÂèØÊåáÂÆöË∂ÖÊó∂Êó∂Èó¥</li>
</ul>
</li>
<li>
<p>docker kill [OPTIONS] CONTAINER [CONTAINER‚Ä¶]</p>
<ul>
<li># ÈªòËÆ§ kill ÂèëÈÄÅ SIGKILL ‰ø°Âè∑-sÂèØ‰ª•ÊåáÂÆöÂèëÈÄÅ kill ‰ø°Âè∑Á±ªÂûã</li>
</ul>
</li>
<li>
<p>docker restart [OPTIONS] CONTAINER [CONTAINER‚Ä¶]</p>
<ul>
<li># ÈáçÂêØ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËøêË°åÁöÑÂÆπÂô®-tÈÄâÈ°πÂèØÊåáÂÆöË∂ÖÊó∂Êó∂Èó¥</li>
</ul>
</li>
<li>
<p>docker pause CONTAINER</p>
<ul>
<li># ÊöÇÂÅú‰∏Ä‰∏™ÂÆπÂô®ÔºåÊñπ‰æø commit</li>
</ul>
</li>
<li>
<p>docker unpause CONTAINER</p>
<ul>
<li># ÁªßÁª≠ÊöÇÂÅúÁöÑÂÆπÂô®</li>
</ul>
</li>
<li>
<p>docker rm [OPTIONS] CONTAINER [CONTAINER‚Ä¶]</p>
<ul>
<li># ÁßªÈô§‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÆπÂô®</li>
<li>-f, --force=false Force removal of running container</li>
<li>-l, --link=false Remove the specified link and not the underlying container</li>
<li>-v, --volumes=false Remove the volumes associated with the container</li>
</ul>
</li>
<li>
<p>docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</p>
<ul>
<li># Êèê‰∫§ÊåáÂÆöÂÆπÂô®‰∏∫ÈïúÂÉè</li>
<li>-a, --author=‚Äú‚Äù Author (e.g., ‚ÄúJohn Hannibal Smith¬†<a href="mailto:hannibal@a-team.com">hannibal@a-team.com</a>‚Äù)</li>
<li>-m, --message=‚Äú‚Äù Commit message</li>
<li>-p, --pause=true Pause container during commit
<ul>
<li># ÈªòËÆ§ commit ÊòØÊöÇÂÅúÁä∂ÊÄÅ</li>
</ul>
</li>
</ul>
</li>
<li>
<p>docker inspect CONTAINER|IMAGE [CONTAINER|IMAGE‚Ä¶]</p>
<ul>
<li># Êü•ÁúãÂÆπÂô®ÊàñËÄÖÈïúÂÉèÁöÑËØ¶ÁªÜ‰ø°ÊÅØ</li>
</ul>
</li>
<li>
<p>docker logs CONTAINER</p>
<ul>
<li># ËæìÂá∫ÊåáÂÆöÂÆπÂô®Êó•Âøó‰ø°ÊÅØ</li>
<li>-f, --follow=false Follow log output
<ul>
<li># Á±ª‰ºº tail -f</li>
</ul>
</li>
<li>-t, --timestamps=false Show timestamps</li>
<li>‚Äìtail=‚Äúall‚Äù Output the specified number of lines at the end of logs (defaults to all logs)</li>
</ul>
</li>
</ul>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/run/">Docker Run Reference</a></p>
<h2 id="4-9-Docker-1-3-Êñ∞Â¢ûÁâπÊÄßÂíåÂëΩ‰ª§"><a class="header-anchor" href="#4-9-Docker-1-3-Êñ∞Â¢ûÁâπÊÄßÂíåÂëΩ‰ª§"></a>4.9 Docker 1.3 Êñ∞Â¢ûÁâπÊÄßÂíåÂëΩ‰ª§</h2>
<h3 id="Digital-Signature-Verification"><a class="header-anchor" href="#Digital-Signature-Verification"></a>Digital Signature Verification</h3>
<p>Docker 1.3 ÁâàÊú¨Â∞Ü‰ΩøÁî®Êï∞Â≠óÁ≠æÂêçËá™Âä®È™åËØÅÊâÄÊúâÂÆòÊñπÂ∫ìÁöÑÊù•Ê∫êÂíåÂÆåÊï¥ÊÄßÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÂÆòÊñπÈïúÂÉèË¢´ÁØ°ÊîπÊàñËÄÖË¢´Á†¥ÂùèÔºåÁõÆÂâç Docker Âè™‰ºöÂØπËøôÁßçÊÉÖÂÜµÂèëÂá∫Ë≠¶ÂëäËÄåÂπ∂‰∏çÈòªÊ≠¢ÂÆπÂô®ÁöÑËøêË°å„ÄÇ</p>
<h3 id="Inject-new-processes-withdocker-exec"><a class="header-anchor" href="#Inject-new-processes-withdocker-exec"></a>Inject new processes withdocker exec</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> --<span class="hljs-built_in">help</span><br>Usage: docker <span class="hljs-built_in">exec</span> [OPTIONS] CONTAINER COMMAND [ARG...] Run a <span class="hljs-built_in">command</span> <span class="hljs-keyword">in</span> an existing container<br>  -d, --detach=<span class="hljs-literal">false</span> Detached mode: run <span class="hljs-built_in">command</span> <span class="hljs-keyword">in</span> the background<br>  -i, --interactive=<span class="hljs-literal">false</span> Keep STDIN open even <span class="hljs-keyword">if</span> not attached<br>  -t, --<span class="hljs-built_in">tty</span>=<span class="hljs-literal">false</span> Allocate a pseudo-TTY<br></code></pre></td></tr></table></figure>
<p>‰∏∫‰∫ÜÁÆÄÂåñË∞ÉËØïÔºåÂèØ‰ª•‰ΩøÁî®docker execÂëΩ‰ª§ÈÄöËøá Docker API Âíå CLI Âú®ËøêË°åÁöÑÂÆπÂô®‰∏äËøêË°åÁ®ãÂ∫è„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker <span class="hljs-built_in">exec</span> -it ubuntu_bash bash<br></code></pre></td></tr></table></figure>
<p>‰∏ä‰æãÂ∞ÜÂú®ÂÆπÂô® ubuntu_bash ‰∏≠ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ Bash ‰ºöËØù„ÄÇ</p>
<h3 id="Tune-container-lifecycles-withdocker-create"><a class="header-anchor" href="#Tune-container-lifecycles-withdocker-create"></a>Tune container lifecycles withdocker create</h3>
<p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøádocker run <image name>ÂëΩ‰ª§ÂàõÂª∫‰∏Ä‰∏™ÂÆπÂô®Âπ∂ËøêË°åÂÖ∂‰∏≠ÁöÑÁ®ãÂ∫èÔºåÂõ†‰∏∫ÊúâÂæàÂ§öÁî®Êà∑Ë¶ÅÊ±ÇÂàõÂª∫ÂÆπÂô®ÁöÑÊó∂ÂÄô‰∏çÂêØÂä®ÂÆπÂô®ÔºåÊâÄ‰ª•docker createÂ∫îËøêËÄåÁîü‰∫Ü„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker create -t -i fedora bash<br>6d8af538ec541dd581ebc2a24153a28329acb5268abe5ef868c1f1a261221752<br></code></pre></td></tr></table></figure>
<p>‰∏ä‰æãÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂèØÂÜôÁöÑÂÆπÂô®Â±Ç (Âπ∂‰∏îÊâìÂç∞Âá∫ÂÆπÂô® ID)Ôºå‰ΩÜÊòØÂπ∂‰∏çËøêË°åÂÆÉÔºåÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§ËøêË°åËØ•ÂÆπÂô®Ôºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker start -a -i 6d8af538ec5<br>bash-4.2<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<h3 id="Security-Options"><a class="header-anchor" href="#Security-Options"></a>Security Options</h3>
<p>ÈÄöËøá‚Äìsecurity-optÈÄâÈ°πÔºåËøêË°åÂÆπÂô®Êó∂Áî®Êà∑ÂèØËá™ÂÆö‰πâ SELinux Âíå AppArmor Âç∑Ê†áÂíåÈÖçÁΩÆ„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker run --security-opt label:<span class="hljs-built_in">type</span>:svirt_apache -i -t centos \ bash<br></code></pre></td></tr></table></figure>
<p>‰∏ä‰æãÂè™ÂÖÅËÆ∏ÂÆπÂô®ÁõëÂê¨Âú® Apache Á´ØÂè£ÔºåËøô‰∏™ÈÄâÈ°πÁöÑÂ•ΩÂ§ÑÊòØÁî®Êà∑‰∏çÈúÄË¶ÅËøêË°å docker ÁöÑÊó∂ÂÄôÊåáÂÆö‚ÄìprivilegedÈÄâÈ°πÔºåÈôç‰ΩéÂÆâÂÖ®È£éÈô©„ÄÇ</p>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="http://blog.docker.com/2014/10/docker-1-3-signed-images-process-injection-security-options-mac-shared-directories/">Docker 1.3: signed images, process injection, security options, Mac shared directories</a></p>
<h2 id="4-10-Docker-1-5-Êñ∞ÁâπÊÄß"><a class="header-anchor" href="#4-10-Docker-1-5-Êñ∞ÁâπÊÄß"></a>4.10 Docker 1.5 Êñ∞ÁâπÊÄß</h2>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="http://dockerone.com/article/202">Docker 1.5 Êñ∞ÁâπÊÄß</a></p>
<h1 id="‰∫î„ÄÅDocker-Á´ØÂè£Êò†Â∞Ñ"><a class="header-anchor" href="#‰∫î„ÄÅDocker-Á´ØÂè£Êò†Â∞Ñ"></a>‰∫î„ÄÅDocker Á´ØÂè£Êò†Â∞Ñ</h1>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Find IP address of container with ID &lt;container_id&gt; ÈÄöËøáÂÆπÂô® id Ëé∑Âèñ ip </span><br>$ sudo docker inspect &lt;container_id&gt; | grep IPAddress | <span class="hljs-built_in">cut</span> -d ‚Äô<span class="hljs-string">&quot;‚Äô -f 4</span><br></code></pre></td></tr></table></figure>
<p>Êó†ËÆ∫Â¶Ç‰ΩïÔºåËøô‰∫õ ip ÊòØÂü∫‰∫éÊú¨Âú∞Á≥ªÁªüÁöÑÂπ∂‰∏îÂÆπÂô®ÁöÑÁ´ØÂè£ÈùûÊú¨Âú∞‰∏ªÊú∫ÊòØËÆøÈóÆ‰∏çÂà∞ÁöÑ„ÄÇÊ≠§Â§ñÔºåÈô§‰∫ÜÁ´ØÂè£Âè™ËÉΩÊú¨Âú∞ËÆøÈóÆÂ§ñÔºåÂØπ‰∫éÂÆπÂô®ÁöÑÂè¶Â§ñ‰∏Ä‰∏™ÈóÆÈ¢òÊòØËøô‰∫õ ip Âú®ÂÆπÂô®ÊØèÊ¨°ÂêØÂä®ÁöÑÊó∂ÂÄôÈÉΩ‰ºöÊîπÂèò„ÄÇ</p>
<p>Docker Ëß£ÂÜ≥‰∫ÜÂÆπÂô®ÁöÑËøô‰∏§‰∏™ÈóÆÈ¢òÔºåÂπ∂‰∏îÁªôÂÆπÂô®ÂÜÖÈÉ®ÊúçÂä°ÁöÑËÆøÈóÆÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïËÄåÂèØÈù†ÁöÑÊñπÊ≥ï„ÄÇDocker ÈÄöËøáÁ´ØÂè£ÁªëÂÆö‰∏ªÊú∫Á≥ªÁªüÁöÑÊé•Âè£ÔºåÂÖÅËÆ∏ÈùûÊú¨Âú∞ÂÆ¢Êà∑Á´ØËÆøÈóÆÂÆπÂô®ÂÜÖÈÉ®ËøêË°åÁöÑÊúçÂä°„ÄÇ‰∏∫‰∫ÜÁÆÄ‰æøÁöÑ‰ΩøÂæóÂÆπÂô®Èó¥ÈÄö‰ø°ÔºåDocker Êèê‰æõ‰∫ÜËøôÁßçËøûÊé•Êú∫Âà∂„ÄÇ</p>
<h2 id="5-1-Ëá™Âä®Êò†Â∞ÑÁ´ØÂè£"><a class="header-anchor" href="#5-1-Ëá™Âä®Êò†Â∞ÑÁ´ØÂè£"></a>5.1 Ëá™Âä®Êò†Â∞ÑÁ´ØÂè£</h2>
<p>-P‰ΩøÁî®Êó∂ÈúÄË¶ÅÊåáÂÆö‚ÄìexposeÈÄâÈ°πÔºåÊåáÂÆöÈúÄË¶ÅÂØπÂ§ñÊèê‰æõÊúçÂä°ÁöÑÁ´ØÂè£</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -P --expose 22 --name server  ubuntu:14.04<br></code></pre></td></tr></table></figure>
<p>‰ΩøÁî®docker run -PËá™Âä®ÁªëÂÆöÊâÄÊúâÂØπÂ§ñÊèê‰æõÊúçÂä°ÁöÑÂÆπÂô®Á´ØÂè£ÔºåÊò†Â∞ÑÁöÑÁ´ØÂè£Â∞Ü‰ºö‰ªéÊ≤°Êúâ‰ΩøÁî®ÁöÑÁ´ØÂè£Ê±†‰∏≠ (49000‚Ä¶49900) Ëá™Âä®ÈÄâÊã©Ôºå‰Ω†ÂèØ‰ª•ÈÄöËøádocker ps„ÄÅdocker inspect &lt;container_id&gt;ÊàñËÄÖdocker port &lt;container_id&gt; <port>Á°ÆÂÆöÂÖ∑‰ΩìÁöÑÁªëÂÆö‰ø°ÊÅØ„ÄÇ</p>
<h2 id="5-2-ÁªëÂÆöÁ´ØÂè£Âà∞ÊåáÂÆöÊé•Âè£"><a class="header-anchor" href="#5-2-ÁªëÂÆöÁ´ØÂè£Âà∞ÊåáÂÆöÊé•Âè£"></a>5.2 ÁªëÂÆöÁ´ØÂè£Âà∞ÊåáÂÆöÊé•Âè£</h2>
<p>Âü∫Êú¨ËØ≠Ê≥ï</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -p [([&lt;host_interface&gt;:[host_port]])|(&lt;host_port&gt;):]&lt;container_port&gt;[/udp] &lt;image&gt; &lt;cmd&gt;<br></code></pre></td></tr></table></figure>
<p>ÈªòËÆ§‰∏çÊåáÂÆöÁªëÂÆö ip ÂàôÁõëÂê¨ÊâÄÊúâÁΩëÁªúÊé•Âè£„ÄÇ</p>
<h3 id="ÁªëÂÆö-TCP-Á´ØÂè£"><a class="header-anchor" href="#ÁªëÂÆö-TCP-Á´ØÂè£"></a>ÁªëÂÆö TCP Á´ØÂè£</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Bind TCP port 8080 of the container to TCP port 80 on 127.0.0.1 of the host machine. </span><br>$ sudo docker run -p 127.0.0.1:80:8080 &lt;image&gt; &lt;cmd&gt; <span class="hljs-comment"># Bind TCP port 8080 of the container to a dynamically allocated TCP port on 127.0.0.1 of the host machine. </span><br>$ sudo docker run -p 127.0.0.1::8080 &lt;image&gt; &lt;cmd&gt; <span class="hljs-comment"># Bind TCP port 8080 of the container to TCP port 80 on all available interfaces of the host machine. </span><br>$ sudo docker run -p 80:8080 &lt;image&gt; &lt;cmd&gt; <span class="hljs-comment"># Bind TCP port 8080 of the container to a dynamically allocated TCP port on all available interfaces </span><br>$ sudo docker run -p 8080 &lt;image&gt; &lt;cmd&gt;<br></code></pre></td></tr></table></figure>
<h3 id="ÁªëÂÆö-UDP-Á´ØÂè£"><a class="header-anchor" href="#ÁªëÂÆö-UDP-Á´ØÂè£"></a>ÁªëÂÆö UDP Á´ØÂè£</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Bind UDP port 5353 of the container to UDP port 53 on 127.0.0.1 of the host machine. </span><br>$ sudo docker run -p 127.0.0.1:53:5353/udp &lt;image&gt; &lt;cmd&gt;<br></code></pre></td></tr></table></figure>
<h1 id="ÂÖ≠„ÄÅDocker-ÁΩëÁªúÈÖçÁΩÆ"><a class="header-anchor" href="#ÂÖ≠„ÄÅDocker-ÁΩëÁªúÈÖçÁΩÆ"></a>ÂÖ≠„ÄÅDocker ÁΩëÁªúÈÖçÁΩÆ</h1>
<p><img src="http://static.open-open.com/lib/uploadImg/20150212/20150212091034_634.png" srcset="/img/loading.gif" lazyload alt="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑ Docker Â≠¶‰π†Á¨îËÆ∞"></p>
<p>Âõæ:¬†<a target="_blank" rel="noopener" href="http://www.slideshare.net/janghoonsim/docker-container-and-lightweight-virtualization">Docker - container and lightweight virtualization</a></p>
<p>Dokcer ÈÄöËøá‰ΩøÁî® Linux Ê°•Êé•Êèê‰æõÂÆπÂô®‰πãÈó¥ÁöÑÈÄö‰ø°Ôºådocker0 Ê°•Êé•Êé•Âè£ÁöÑÁõÆÁöÑÂ∞±ÊòØÊñπ‰æø Docker ÁÆ°ÁêÜ„ÄÇÂΩì Docker daemon ÂêØÂä®Êó∂ÈúÄË¶ÅÂÅö‰ª•‰∏ãÊìç‰ΩúÔºö</p>
<ul>
<li>creates the docker0 bridge if not present
<ul>
<li># Â¶ÇÊûú docker0 ‰∏çÂ≠òÂú®ÂàôÂàõÂª∫</li>
</ul>
</li>
<li>searches for an IP address range which doesn‚Äôt overlap with an existing route
<ul>
<li># ÊêúÁ¥¢‰∏Ä‰∏™‰∏éÂΩìÂâçË∑ØÁî±‰∏çÂÜ≤Á™ÅÁöÑ ip ÊÆµ</li>
</ul>
</li>
<li>picks an IP in the selected range
<ul>
<li># Âú®Á°ÆÂÆöÁöÑËåÉÂõ¥‰∏≠ÈÄâÊã© ip</li>
</ul>
</li>
<li>assigns this IP to the docker0 bridge
<ul>
<li># ÁªëÂÆö ip Âà∞ docker0</li>
</ul>
</li>
</ul>
<h2 id="6-1-Docker-ÂõõÁßçÁΩëÁªúÊ®°Âºè"><a class="header-anchor" href="#6-1-Docker-ÂõõÁßçÁΩëÁªúÊ®°Âºè"></a>6.1 Docker ÂõõÁßçÁΩëÁªúÊ®°Âºè</h2>
<p>ÂõõÁßçÁΩëÁªúÊ®°ÂºèÊëòËá™¬†<a target="_blank" rel="noopener" href="http://www.infoq.com/cn/articles/docker-network-and-pipework-open-source-explanation-practice">Docker ÁΩëÁªúËØ¶Ëß£Âèä pipework Ê∫êÁ†ÅËß£ËØª‰∏éÂÆûË∑µ</a></p>
<p>docker run ÂàõÂª∫ Docker ÂÆπÂô®Êó∂ÔºåÂèØ‰ª•Áî® --net ÈÄâÈ°πÊåáÂÆöÂÆπÂô®ÁöÑÁΩëÁªúÊ®°ÂºèÔºåDocker Êúâ‰ª•‰∏ã 4 ÁßçÁΩëÁªúÊ®°ÂºèÔºö</p>
<ul>
<li>host Ê®°ÂºèÔºå‰ΩøÁî® --net=host ÊåáÂÆö„ÄÇ</li>
<li>container Ê®°ÂºèÔºå‰ΩøÁî® --net=container:NAMEorID ÊåáÂÆö„ÄÇ</li>
<li>none Ê®°ÂºèÔºå‰ΩøÁî® --net=none ÊåáÂÆö„ÄÇ</li>
<li>bridge Ê®°ÂºèÔºå‰ΩøÁî® --net=bridge ÊåáÂÆöÔºåÈªòËÆ§ËÆæÁΩÆ„ÄÇ</li>
</ul>
<h3 id="host-Ê®°Âºè"><a class="header-anchor" href="#host-Ê®°Âºè"></a>host Ê®°Âºè</h3>
<p>Â¶ÇÊûúÂêØÂä®ÂÆπÂô®ÁöÑÊó∂ÂÄô‰ΩøÁî® host Ê®°ÂºèÔºåÈÇ£‰πàËøô‰∏™ÂÆπÂô®Â∞Ü‰∏ç‰ºöËé∑Âæó‰∏Ä‰∏™Áã¨Á´ãÁöÑ Network NamespaceÔºåËÄåÊòØÂíåÂÆø‰∏ªÊú∫ÂÖ±Áî®‰∏Ä‰∏™ Network Namespace„ÄÇÂÆπÂô®Â∞Ü‰∏ç‰ºöËôöÊãüÂá∫Ëá™Â∑±ÁöÑÁΩëÂç°ÔºåÈÖçÁΩÆËá™Â∑±ÁöÑ IP Á≠âÔºåËÄåÊòØ‰ΩøÁî®ÂÆø‰∏ªÊú∫ÁöÑ IP ÂíåÁ´ØÂè£„ÄÇ</p>
<p>‰æãÂ¶ÇÔºåÊàë‰ª¨Âú® 10.10.101.105/24 ÁöÑÊú∫Âô®‰∏äÁî® host Ê®°ÂºèÂêØÂä®‰∏Ä‰∏™Âê´Êúâ web Â∫îÁî®ÁöÑ Docker ÂÆπÂô®ÔºåÁõëÂê¨ tcp 80 Á´ØÂè£„ÄÇÂΩìÊàë‰ª¨Âú®ÂÆπÂô®‰∏≠ÊâßË°å‰ªª‰ΩïÁ±ª‰ºº ifconfig ÂëΩ‰ª§Êü•ÁúãÁΩëÁªúÁéØÂ¢ÉÊó∂ÔºåÁúãÂà∞ÁöÑÈÉΩÊòØÂÆø‰∏ªÊú∫‰∏äÁöÑ‰ø°ÊÅØ„ÄÇËÄåÂ§ñÁïåËÆøÈóÆÂÆπÂô®‰∏≠ÁöÑÂ∫îÁî®ÔºåÂàôÁõ¥Êé•‰ΩøÁî® 10.10.101.105:80 Âç≥ÂèØÔºå‰∏çÁî®‰ªª‰Ωï NAT ËΩ¨Êç¢ÔºåÂ∞±Â¶ÇÁõ¥Êé•Ë∑ëÂú®ÂÆø‰∏ªÊú∫‰∏≠‰∏ÄÊ†∑„ÄÇ‰ΩÜÊòØÔºåÂÆπÂô®ÁöÑÂÖ∂‰ªñÊñπÈù¢ÔºåÂ¶ÇÊñá‰ª∂Á≥ªÁªü„ÄÅËøõÁ®ãÂàóË°®Á≠âËøòÊòØÂíåÂÆø‰∏ªÊú∫ÈöîÁ¶ªÁöÑ„ÄÇ</p>
<h3 id="container-Ê®°Âºè"><a class="header-anchor" href="#container-Ê®°Âºè"></a>container Ê®°Âºè</h3>
<p>Ëøô‰∏™Ê®°ÂºèÊåáÂÆöÊñ∞ÂàõÂª∫ÁöÑÂÆπÂô®ÂíåÂ∑≤ÁªèÂ≠òÂú®ÁöÑ‰∏Ä‰∏™ÂÆπÂô®ÂÖ±‰∫´‰∏Ä‰∏™ Network NamespaceÔºåËÄå‰∏çÊòØÂíåÂÆø‰∏ªÊú∫ÂÖ±‰∫´„ÄÇÊñ∞ÂàõÂª∫ÁöÑÂÆπÂô®‰∏ç‰ºöÂàõÂª∫Ëá™Â∑±ÁöÑÁΩëÂç°ÔºåÈÖçÁΩÆËá™Â∑±ÁöÑ IPÔºåËÄåÊòØÂíå‰∏Ä‰∏™ÊåáÂÆöÁöÑÂÆπÂô®ÂÖ±‰∫´ IP„ÄÅÁ´ØÂè£ËåÉÂõ¥Á≠â„ÄÇÂêåÊ†∑Ôºå‰∏§‰∏™ÂÆπÂô®Èô§‰∫ÜÁΩëÁªúÊñπÈù¢ÔºåÂÖ∂‰ªñÁöÑÂ¶ÇÊñá‰ª∂Á≥ªÁªü„ÄÅËøõÁ®ãÂàóË°®Á≠âËøòÊòØÈöîÁ¶ªÁöÑ„ÄÇ‰∏§‰∏™ÂÆπÂô®ÁöÑËøõÁ®ãÂèØ‰ª•ÈÄöËøá lo ÁΩëÂç°ËÆæÂ§áÈÄö‰ø°„ÄÇ</p>
<h3 id="noneÊ®°Âºè"><a class="header-anchor" href="#noneÊ®°Âºè"></a>noneÊ®°Âºè</h3>
<p>Ëøô‰∏™Ê®°ÂºèÂíåÂâç‰∏§‰∏™‰∏çÂêå„ÄÇÂú®ËøôÁßçÊ®°Âºè‰∏ãÔºåDocker ÂÆπÂô®Êã•ÊúâËá™Â∑±ÁöÑ Network NamespaceÔºå‰ΩÜÊòØÔºåÂπ∂‰∏ç‰∏∫ DockerÂÆπÂô®ËøõË°å‰ªª‰ΩïÁΩëÁªúÈÖçÁΩÆ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåËøô‰∏™ Docker ÂÆπÂô®Ê≤°ÊúâÁΩëÂç°„ÄÅIP„ÄÅË∑ØÁî±Á≠â‰ø°ÊÅØ„ÄÇÈúÄË¶ÅÊàë‰ª¨Ëá™Â∑±‰∏∫ Docker ÂÆπÂô®Ê∑ªÂä†ÁΩëÂç°„ÄÅÈÖçÁΩÆ IP Á≠â„ÄÇ</p>
<h3 id="bridgeÊ®°Âºè"><a class="header-anchor" href="#bridgeÊ®°Âºè"></a>bridgeÊ®°Âºè</h3>
<p><img src="http://static.open-open.com/lib/uploadImg/20150212/20150212091035_252.png" srcset="/img/loading.gif" lazyload alt="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑ Docker Â≠¶‰π†Á¨îËÆ∞"></p>
<p>Âõæ:<a target="_blank" rel="noopener" href="http://www.wickedawesometech.us/2014/07/the-container-world-part-2-networking.html">The Container World | Part 2 Networking</a></p>
<p>bridge Ê®°ÂºèÊòØ Docker ÈªòËÆ§ÁöÑÁΩëÁªúËÆæÁΩÆÔºåÊ≠§Ê®°Âºè‰ºö‰∏∫ÊØè‰∏Ä‰∏™ÂÆπÂô®ÂàÜÈÖç Network Namespace„ÄÅËÆæÁΩÆ IP Á≠âÔºåÂπ∂Â∞Ü‰∏Ä‰∏™‰∏ªÊú∫‰∏äÁöÑ Docker ÂÆπÂô®ËøûÊé•Âà∞‰∏Ä‰∏™ËôöÊãüÁΩëÊ°•‰∏ä„ÄÇÂΩì Docker server ÂêØÂä®Êó∂Ôºå‰ºöÂú®‰∏ªÊú∫‰∏äÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ docker0 ÁöÑËôöÊãüÁΩëÊ°•ÔºåÊ≠§‰∏ªÊú∫‰∏äÂêØÂä®ÁöÑ Docker ÂÆπÂô®‰ºöËøûÊé•Âà∞Ëøô‰∏™ËôöÊãüÁΩëÊ°•‰∏ä„ÄÇËôöÊãüÁΩëÊ°•ÁöÑÂ∑•‰ΩúÊñπÂºèÂíåÁâ©ÁêÜ‰∫§Êç¢Êú∫Á±ª‰ººÔºåËøôÊ†∑‰∏ªÊú∫‰∏äÁöÑÊâÄÊúâÂÆπÂô®Â∞±ÈÄöËøá‰∫§Êç¢Êú∫ËøûÂú®‰∫Ü‰∏Ä‰∏™‰∫åÂ±ÇÁΩëÁªú‰∏≠„ÄÇÊé•‰∏ãÊù•Â∞±Ë¶Å‰∏∫ÂÆπÂô®ÂàÜÈÖç IP ‰∫ÜÔºåDocker ‰ºö‰ªé RFC1918 ÊâÄÂÆö‰πâÁöÑÁßÅÊúâ IP ÁΩëÊÆµ‰∏≠ÔºåÈÄâÊã©‰∏Ä‰∏™ÂíåÂÆø‰∏ªÊú∫‰∏çÂêåÁöÑIPÂú∞ÂùÄÂíåÂ≠êÁΩëÂàÜÈÖçÁªô docker0ÔºåËøûÊé•Âà∞ docker0 ÁöÑÂÆπÂô®Â∞±‰ªéËøô‰∏™Â≠êÁΩë‰∏≠ÈÄâÊã©‰∏Ä‰∏™Êú™Âç†Áî®ÁöÑ IP ‰ΩøÁî®„ÄÇÂ¶Ç‰∏ÄËà¨ Docker ‰ºö‰ΩøÁî® 172.17.0.0/16 Ëøô‰∏™ÁΩëÊÆµÔºåÂπ∂Â∞Ü 172.17.42.1/16 ÂàÜÈÖçÁªô docker0 ÁΩëÊ°•ÔºàÂú®‰∏ªÊú∫‰∏ä‰ΩøÁî® ifconfig ÂëΩ‰ª§ÊòØÂèØ‰ª•ÁúãÂà∞ docker0 ÁöÑÔºåÂèØ‰ª•ËÆ§‰∏∫ÂÆÉÊòØÁΩëÊ°•ÁöÑÁÆ°ÁêÜÊé•Âè£ÔºåÂú®ÂÆø‰∏ªÊú∫‰∏ä‰Ωú‰∏∫‰∏ÄÂùóËôöÊãüÁΩëÂç°‰ΩøÁî®Ôºâ</p>
<h2 id="6-2-ÂàóÂá∫ÂΩìÂâç‰∏ªÊú∫ÁΩëÊ°•"><a class="header-anchor" href="#6-2-ÂàóÂá∫ÂΩìÂâç‰∏ªÊú∫ÁΩëÊ°•"></a>6.2 ÂàóÂá∫ÂΩìÂâç‰∏ªÊú∫ÁΩëÊ°•</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo brctl show <span class="hljs-comment"># brctl Â∑•ÂÖ∑‰æùËµñ bridge-utils ËΩØ‰ª∂ÂåÖ bridge name bridge id STP enabled interfaces</span><br>docker0 8000.000000000000 no<br></code></pre></td></tr></table></figure>
<h2 id="6-3-Êü•ÁúãÂΩìÂâç-docker0-ip"><a class="header-anchor" href="#6-3-Êü•ÁúãÂΩìÂâç-docker0-ip"></a>6.3 Êü•ÁúãÂΩìÂâç docker0 ip</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo ifconfig docker0<br>docker0 Link encap:Ethernet HWaddr xx:xx:xx:xx:xx:xx<br>inet addr:172.17.42.1 Bcast:0.0.0.0 Mask:255.255.0.0<br></code></pre></td></tr></table></figure>
<p>Âú®ÂÆπÂô®ËøêË°åÊó∂ÔºåÊØè‰∏™ÂÆπÂô®ÈÉΩ‰ºöÂàÜÈÖç‰∏Ä‰∏™ÁâπÂÆöÁöÑËôöÊãüÊú∫Âè£Âπ∂Ê°•Êé•Âà∞ docker0„ÄÇÊØè‰∏™ÂÆπÂô®ÈÉΩ‰ºöÈÖçÁΩÆÂêå docker0 ip Áõ∏ÂêåÁΩëÊÆµÁöÑ‰∏ìÁî® ip Âú∞ÂùÄÔºådocker0 ÁöÑ IP Âú∞ÂùÄË¢´Áî®‰∫éÊâÄÊúâÂÆπÂô®ÁöÑÈªòËÆ§ÁΩëÂÖ≥„ÄÇ</p>
<h2 id="6-4-ËøêË°å‰∏Ä‰∏™ÂÆπÂô®"><a class="header-anchor" href="#6-4-ËøêË°å‰∏Ä‰∏™ÂÆπÂô®"></a>6.4 ËøêË°å‰∏Ä‰∏™ÂÆπÂô®</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i -d ubuntu /bin/bash<br>52f811c5d3d69edddefc75aff5a4525fc8ba8bcfa1818132f9dc7d4f7c7e78b4 <br>$ sudo brctl show<br>bridge name bridge <span class="hljs-built_in">id</span> STP enabled interfaces<br>docker0 8000.fef213db5a66 no vethQCDY1N<br></code></pre></td></tr></table></figure>
<p>‰ª•‰∏ä, docker0 ÊâÆÊºîÁùÄ 52f811c5d3d6 container Ëøô‰∏™ÂÆπÂô®ÁöÑËôöÊãüÊé•Âè£ vethQCDY1N interface Ê°•Êé•ÁöÑËßíËâ≤„ÄÇ</p>
<h3 id="‰ΩøÁî®ÁâπÂÆöËåÉÂõ¥ÁöÑ-IP"><a class="header-anchor" href="#‰ΩøÁî®ÁâπÂÆöËåÉÂõ¥ÁöÑ-IP"></a>‰ΩøÁî®ÁâπÂÆöËåÉÂõ¥ÁöÑ IP</h3>
<p>Docker ‰ºöÂ∞ùËØïÂØªÊâæÊ≤°ÊúâË¢´‰∏ªÊú∫‰ΩøÁî®ÁöÑ ip ÊÆµÔºåÂ∞ΩÁÆ°ÂÆÉÈÄÇÁî®‰∫éÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºå‰ΩÜÊòØÂÆÉ‰∏çÊòØ‰∏áËÉΩÁöÑÔºåÊúâÊó∂ÂÄôÊàë‰ª¨ËøòÊòØÈúÄË¶ÅÂØπ ip Ëøõ‰∏ÄÊ≠•ËßÑÂàí„ÄÇDocker ÂÖÅËÆ∏‰Ω†ÁÆ°ÁêÜ docker0 Ê°•Êé•ÊàñËÄÖÈÄöËøá-bÈÄâÈ°πËá™ÂÆö‰πâÊ°•Êé•ÁΩëÂç°ÔºåÈúÄË¶ÅÂÆâË£Öbridge-utilsËΩØ‰ª∂ÂåÖ„ÄÇ</p>
<p>Âü∫Êú¨Ê≠•È™§Â¶Ç‰∏ãÔºö</p>
<ul>
<li>
<p>ensure Docker is stopped</p>
<ul>
<li># Á°Æ‰øù docker ÁöÑËøõÁ®ãÊòØÂÅúÊ≠¢ÁöÑ</li>
</ul>
</li>
<li>
<p>create your own bridge (bridge0 for example)</p>
<ul>
<li># ÂàõÂª∫Ëá™ÂÆö‰πâÁΩëÊ°•</li>
</ul>
</li>
<li>
<p>assign a specific IP to this bridge</p>
<ul>
<li># ÁªôÁΩëÊ°•ÂàÜÈÖçÁâπÂÆöÁöÑ ip</li>
</ul>
</li>
<li>
<p>start Docker with the -b=bridge0 parameter</p>
<ul>
<li># ‰ª• -b ÁöÑÊñπÂºèÊåáÂÆöÁΩëÊ°•</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Stopping Docker and removing docker0 </span><br>$ sudo service docker stop <br>$ sudo ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> dev docker0 down <br>$ sudo brctl delbr docker0 <span class="hljs-comment"># Create our own bridge </span><br>$ sudo brctl addbr bridge0 <br>$ sudo ip addr add 192.168.5.1/24 dev bridge0 <br>$ sudo ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> dev bridge0 up <span class="hljs-comment"># Confirming that our bridge is up and running </span><br>$ ip addr show bridge0<br>4: bridge0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state UP group default<br>    <span class="hljs-built_in">link</span>/ether 66:38:d0:0d:76:18 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.5.1/24 scope global bridge0<br>       valid_lft forever preferred_lft forever <span class="hljs-comment"># Tell Docker about it and restart (on Ubuntu) </span><br>$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;DOCKER_OPTS=&quot;-b=bridge0&quot;&#x27;</span> &gt;&gt; /etc/default/docker <br>$ sudo service docker start<br></code></pre></td></tr></table></figure>
<p>ÂèÇËÄÉÊñáÊ°£:¬†<a target="_blank" rel="noopener" href="https://docs.docker.com/articles/networking/">Network Configuration</a></p>
<h2 id="6-5-‰∏çÂêå‰∏ªÊú∫Èó¥ÂÆπÂô®ÈÄö‰ø°"><a class="header-anchor" href="#6-5-‰∏çÂêå‰∏ªÊú∫Èó¥ÂÆπÂô®ÈÄö‰ø°"></a>6.5 ‰∏çÂêå‰∏ªÊú∫Èó¥ÂÆπÂô®ÈÄö‰ø°</h2>
<p>‰∏çÂêåÂÆπÂô®‰πãÈó¥ÁöÑÈÄö‰ø°ÂèØ‰ª•ÂÄüÂä©‰∫é pipework Ëøô‰∏™Â∑•ÂÖ∑Ôºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> https://github.com/jpetazzo/pipework.git<br>$ sudo <span class="hljs-built_in">cp</span> -rp pipework/pipework /usr/local/bin/<br></code></pre></td></tr></table></figure>
<h3 id="ÂÆâË£ÖÁõ∏Â∫î‰æùËµñËΩØ‰ª∂"><a class="header-anchor" href="#ÂÆâË£ÖÁõ∏Â∫î‰æùËµñËΩØ‰ª∂"></a>ÂÆâË£ÖÁõ∏Â∫î‰æùËµñËΩØ‰ª∂</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo apt-get install iputils-arping bridge-utils -y<br></code></pre></td></tr></table></figure>
<h3 id="Ê°•Êé•ÁΩëÁªú"><a class="header-anchor" href="#Ê°•Êé•ÁΩëÁªú"></a>Ê°•Êé•ÁΩëÁªú</h3>
<p>Ê°•Êé•ÁΩëÁªúÂèØ‰ª•ÂèÇËÄÉ¬†<a target="_blank" rel="noopener" href="https://github.com/opskumu/Day/blob/master/tips/tips.md">Êó•Â∏∏ÈóÆÈ¢òÂ§ÑÁêÜ Tips</a>¬†ÂÖ≥‰∫éÊ°•Êé•ÁöÑÈÖçÁΩÆËØ¥ÊòéÔºåËøôÈáå‰∏çÂÜçËµòËø∞„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># brctl show</span><br>bridge name     bridge <span class="hljs-built_in">id</span>               STP enabled     interfaces<br>br0             8000.000c291412cd       no              eth0<br>docker0         8000.56847afe9799       no              vetheb48029<br></code></pre></td></tr></table></figure>
<p>ÂèØ‰ª•Âà†Èô§ docker0ÔºåÁõ¥Êé•Êää docker ÁöÑÊ°•Êé•ÊåáÂÆö‰∏∫ br0„ÄÇ‰πüÂèØ‰ª•‰øùÁïô‰ΩøÁî®ÈªòËÆ§ÁöÑÈÖçÁΩÆÔºåËøôÊ†∑Âçï‰∏ªÊú∫ÂÆπÂô®‰πãÈó¥ÁöÑÈÄö‰ø°ÂèØ‰ª•ÈÄöËøá docker0ÔºåËÄåË∑®‰∏ªÊú∫‰∏çÂêåÂÆπÂô®‰πãÈó¥ÈÄöËøá pipework Êñ∞Âª∫ docker ÂÆπÂô®ÁöÑÁΩëÂç°Ê°•Êé•Âà∞ br0ÔºåËøôÊ†∑Ë∑®‰∏ªÊú∫ÂÆπÂô®‰πãÈó¥Â∞±ÂèØ‰ª•ÈÄö‰ø°‰∫Ü„ÄÇ</p>
<ul>
<li>ubuntu</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo service docker stop<br>$ sudo ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> dev docker0 down<br>$ sudo brctl delbr docker0<br>$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;DOCKER_OPTS=&quot;-b=br0&quot;&#x27;</span> &gt;&gt; /etc/default/docker<br>$ sudo service docker start<br></code></pre></td></tr></table></figure>
<ul>
<li>CentOS 7/RHEL 7</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo systemctl stop docker<br>$ sudo ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> dev docker0 down<br>$ sudo brctl delbr docker0<br>$ <span class="hljs-built_in">cat</span> /etc/sysconfig/docker | grep <span class="hljs-string">&#x27;OPTIONS=&#x27;</span><br>OPTIONS=--selinux-enabled -b=br0 -H fd://<br>$ sudo systemctl start docker<br></code></pre></td></tr></table></figure>
<h3 id="pipework"><a class="header-anchor" href="#pipework"></a>pipework</h3>
<p><img src="http://static.open-open.com/lib/uploadImg/20150212/20150212091035_900.png" srcset="/img/loading.gif" lazyload alt="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑ Docker Â≠¶‰π†Á¨îËÆ∞"></p>
<p>‰∏çÂêåÂÆπÂô®‰πãÈó¥ÁöÑÈÄö‰ø°ÂèØ‰ª•ÂÄüÂä©‰∫é pipework Ëøô‰∏™Â∑•ÂÖ∑Áªô docker ÂÆπÂô®Êñ∞Âª∫ËôöÊãüÁΩëÂç°Âπ∂ÁªëÂÆö IP Ê°•Êé•Âà∞ br0</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> https://github.com/jpetazzo/pipework.git<br>$ sudo <span class="hljs-built_in">cp</span> -rp pipework/pipework /usr/local/bin/<br>$ pipework <br>Syntax:<br>pipework &lt;hostinterface&gt; [-i containerinterface] &lt;guest&gt; &lt;ipaddr&gt;/&lt;subnet&gt;[@default_gateway] [macaddr][@vlan]<br>pipework &lt;hostinterface&gt; [-i containerinterface] &lt;guest&gt; dhcp [macaddr][@vlan]<br>pipework --<span class="hljs-built_in">wait</span> [-i containerinterface]<br></code></pre></td></tr></table></figure>
<p>Â¶ÇÊûúÂà†Èô§‰∫ÜÈªòËÆ§ÁöÑ docker0 Ê°•Êé•ÔºåÊää docker ÈªòËÆ§Ê°•Êé•ÊåáÂÆöÂà∞‰∫Ü br0ÔºåÂàôÊúÄÂ•ΩÂú®ÂàõÂª∫ÂÆπÂô®ÁöÑÊó∂ÂÄôÂä†‰∏ä‚Äìnet=noneÔºåÈò≤Ê≠¢Ëá™Âä®ÂàÜÈÖçÁöÑ IP Âú®Â±ÄÂüüÁΩë‰∏≠ÊúâÂÜ≤Á™Å„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --<span class="hljs-built_in">rm</span> -ti --net=none ubuntu:14.04 /bin/bash<br>root@a46657528059:/<span class="hljs-comment">#</span><br>$                  <span class="hljs-comment"># Ctrl-P + Ctrl-Q ÂõûÂà∞ÂÆø‰∏ªÊú∫ shellÔºåÂÆπÂô® detach Áä∂ÊÄÅ</span><br>$ sudo docker  ps<br>CONTAINER ID    IMAGE          COMMAND       CREATED         STATUS          PORTS      NAMES<br>a46657528059    ubuntu:14.04   <span class="hljs-string">&quot;/bin/bash&quot;</span>   4 minutes ago   Up 4 minutes               hungry_lalande<br>$ sudo pipework br0 -i eth0 a46657528059 192.168.115.10/24@192.168.115.2 <br><span class="hljs-comment"># ÈªòËÆ§‰∏çÊåáÂÆöÁΩëÂç°ËÆæÂ§áÂêçÔºåÂàôÈªòËÆ§Ê∑ªÂä†‰∏∫ eth1</span><br><span class="hljs-comment"># Âè¶Â§ñ pipework ‰∏çËÉΩÊ∑ªÂä†ÈùôÊÄÅË∑ØÁî±ÔºåÂ¶ÇÊûúÊúâÈúÄÊ±ÇÂàôÂèØ‰ª•Âú® run ÁöÑÊó∂ÂÄôÂä†‰∏ä --privileged=true ÊùÉÈôêÂú®ÂÆπÂô®‰∏≠ÊâãÂä®Ê∑ªÂä†Ôºå</span><br><span class="hljs-comment"># ‰ΩÜËøôÁßçÂÆâÂÖ®ÊÄßÊúâÁº∫Èô∑ÔºåÂèØ‰ª•ÈÄöËøá ip netns Êìç‰Ωú</span><br>$ sudo docker attach a46657528059<br>root@a46657528059:/<span class="hljs-comment"># ifconfig eth0</span><br>eth0      Link encap:Ethernet  HWaddr 86:b6:6b:e8:2e:4d  <br>          inet addr:192.168.115.10  Bcast:0.0.0.0  Mask:255.255.255.0<br>          inet6 addr: fe80::84b6:6bff:fee8:2e4d/64 Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br>          RX packets:8 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:9 errors:0 dropped:0 overruns:0 carrier:0<br>          collisions:0 txqueuelen:1000 <br>          RX bytes:648 (648.0 B)  TX bytes:690 (690.0 B)<br><br>root@a46657528059:/<span class="hljs-comment"># route -n</span><br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>0.0.0.0         192.168.115.2   0.0.0.0         UG    0      0        0 eth0<br>192.168.115.0   0.0.0.0         255.255.255.0   U     0      0        0 eth0<br></code></pre></td></tr></table></figure>
<p>‰ΩøÁî®ip netnsÊ∑ªÂä†ÈùôÊÄÅË∑ØÁî±ÔºåÈÅøÂÖçÂàõÂª∫ÂÆπÂô®‰ΩøÁî®‚Äìprivileged=trueÈÄâÈ°πÈÄ†Êàê‰∏Ä‰∫õ‰∏çÂøÖË¶ÅÁöÑÂÆâÂÖ®ÈóÆÈ¢òÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker inspect --format=<span class="hljs-string">&quot;&#123;&#123; .State.Pid &#125;&#125;&quot;</span> a46657528059 <span class="hljs-comment"># Ëé∑ÂèñÊåáÂÆöÂÆπÂô® pid</span><br>6350<br>$ sudo <span class="hljs-built_in">ln</span> -s /proc/6350/ns/net /var/run/netns/6350<br>$ sudo ip netns <span class="hljs-built_in">exec</span> 6350 ip route add 192.168.0.0/16 dev eth0 via 192.168.115.2<br>$ sudo ip netns <span class="hljs-built_in">exec</span> 6350 ip route    <span class="hljs-comment"># Ê∑ªÂä†ÊàêÂäü</span><br>192.168.0.0/16 via 192.168.115.2 dev eth0 <br>... ...<br></code></pre></td></tr></table></figure>
<p>Âú®ÂÖ∂ÂÆÉÂÆø‰∏ªÊú∫ËøõË°åÁõ∏Â∫îÁöÑÈÖçÁΩÆÔºåÊñ∞Âª∫ÂÆπÂô®Âπ∂‰ΩøÁî® pipework Ê∑ªÂä†ËôöÊãüÁΩëÂç°Ê°•Êé•Âà∞ br0ÔºåÊµãËØïÈÄö‰ø°ÊÉÖÂÜµÂç≥ÂèØ„ÄÇ</p>
<p>Âè¶Â§ñÔºåpipework ÂèØ‰ª•ÂàõÂª∫ÂÆπÂô®ÁöÑ vlan ÁΩëÁªúÔºåËøôÈáå‰∏ç‰ΩúËøáÂ§öÁöÑ‰ªãÁªç‰∫ÜÔºåÂÆòÊñπÊñáÊ°£Â∑≤ÁªèÂÜôÁöÑÂæàÊ∏ÖÊ•ö‰∫ÜÔºåÂèØ‰ª•Êü•Áúã‰ª•‰∏ã‰∏§ÁØáÊñáÁ´†Ôºö</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/jpetazzo/pipework">Pipework ÂÆòÊñπÊñáÊ°£</a></li>
<li><a target="_blank" rel="noopener" href="http://www.infoq.com/cn/articles/docker-network-and-pipework-open-source-explanation-practice">Docker ÁΩëÁªúËØ¶Ëß£Âèä pipework Ê∫êÁ†ÅËß£ËØª‰∏éÂÆûË∑µ</a></li>
</ul>
<h1 id="‰∏É„ÄÅDockerfile"><a class="header-anchor" href="#‰∏É„ÄÅDockerfile"></a>‰∏É„ÄÅDockerfile</h1>
<p>Docker ÂèØ‰ª•ÈÄöËøá Dockerfile ÁöÑÂÜÖÂÆπÊù•Ëá™Âä®ÊûÑÂª∫ÈïúÂÉè„ÄÇDockerfile ÊòØ‰∏Ä‰∏™ÂåÖÂê´ÂàõÂª∫ÈïúÂÉèÊâÄÊúâÂëΩ‰ª§ÁöÑÊñáÊú¨Êñá‰ª∂ÔºåÈÄöËøádocker buildÂëΩ‰ª§ÂèØ‰ª•Ê†πÊçÆ Dockerfile ÁöÑÂÜÖÂÆπÊûÑÂª∫ÈïúÂÉèÔºåÂú®‰ªãÁªçÂ¶Ç‰ΩïÊûÑÂª∫‰πãÂâçÂÖà‰ªãÁªç‰∏ã Dockerfile ÁöÑÂü∫Êú¨ËØ≠Ê≥ïÁªìÊûÑ„ÄÇ</p>
<p>Dockerfile Êúâ‰ª•‰∏ãÊåá‰ª§ÈÄâÈ°π:</p>
<ul>
<li>FROM</li>
<li>MAINTAINER</li>
<li>RUN</li>
<li>CMD</li>
<li>EXPOSE</li>
<li>ENV</li>
<li>ADD</li>
<li>COPY</li>
<li>ENTRYPOINT</li>
<li>VOLUME</li>
<li>USER</li>
<li>WORKDIR</li>
<li>ONBUILD</li>
</ul>
<h2 id="7-1-FROM"><a class="header-anchor" href="#7-1-FROM"></a>7.1 FROM</h2>
<p>Áî®Ê≥ï:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM &lt;image&gt;<br></code></pre></td></tr></table></figure>
<p>ÊàñËÄÖ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM &lt;image&gt;<br></code></pre></td></tr></table></figure>
<ul>
<li>FROMÊåáÂÆöÊûÑÂª∫ÈïúÂÉèÁöÑÂü∫Á°ÄÊ∫êÈïúÂÉèÔºåÂ¶ÇÊûúÊú¨Âú∞Ê≤°ÊúâÊåáÂÆöÁöÑÈïúÂÉèÔºåÂàô‰ºöËá™Âä®‰ªé Docker ÁöÑÂÖ¨ÂÖ±Â∫ì pull ÈïúÂÉè‰∏ãÊù•„ÄÇ</li>
<li>FROMÂøÖÈ°ªÊòØ Dockerfile ‰∏≠ÈùûÊ≥®ÈáäË°åÁöÑÁ¨¨‰∏Ä‰∏™Êåá‰ª§ÔºåÂç≥‰∏Ä‰∏™ Dockerfile ‰ªéFROMËØ≠Âè•ÂºÄÂßã„ÄÇ</li>
<li>FROMÂèØ‰ª•Âú®‰∏Ä‰∏™ Dockerfile ‰∏≠Âá∫Áé∞Â§öÊ¨°ÔºåÂ¶ÇÊûúÊúâÈúÄÊ±ÇÂú®‰∏Ä‰∏™ Dockerfile ‰∏≠ÂàõÂª∫Â§ö‰∏™ÈïúÂÉè„ÄÇ</li>
<li>Â¶ÇÊûúFROMËØ≠Âè•Ê≤°ÊúâÊåáÂÆöÈïúÂÉèÊ†áÁ≠æÔºåÂàôÈªòËÆ§‰ΩøÁî®latestÊ†áÁ≠æ„ÄÇ</li>
</ul>
<h2 id="7-2-MAINTAINER"><a class="header-anchor" href="#7-2-MAINTAINER"></a>7.2 MAINTAINER</h2>
<p>Áî®Ê≥ï:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">MAINTAINER &lt;name&gt;<br></code></pre></td></tr></table></figure>
<p>ÊåáÂÆöÂàõÂª∫ÈïúÂÉèÁöÑÁî®Êà∑</p>
<p>RUN Êúâ‰∏§Áßç‰ΩøÁî®ÊñπÂºè</p>
<ul>
<li>RUN</li>
<li>RUN¬†<a target="_blank" rel="noopener" href="http://opskumu.github.io/exec%20form">‚Äúexecutable‚Äù, ‚Äúparam1‚Äù, ‚Äúparam2‚Äù</a></li>
</ul>
<p>ÊØèÊù°RUNÊåá‰ª§Â∞ÜÂú®ÂΩìÂâçÈïúÂÉèÂü∫Á°Ä‰∏äÊâßË°åÊåáÂÆöÂëΩ‰ª§ÔºåÂπ∂Êèê‰∫§‰∏∫Êñ∞ÁöÑÈïúÂÉèÔºåÂêéÁª≠ÁöÑRUNÈÉΩÂú®‰πãÂâçRUNÊèê‰∫§ÂêéÁöÑÈïúÂÉè‰∏∫Âü∫Á°ÄÔºåÈïúÂÉèÊòØÂàÜÂ±ÇÁöÑÔºåÂèØ‰ª•ÈÄöËøá‰∏Ä‰∏™ÈïúÂÉèÁöÑ‰ªª‰Ωï‰∏Ä‰∏™ÂéÜÂè≤Êèê‰∫§ÁÇπÊù•ÂàõÂª∫ÔºåÁ±ª‰ººÊ∫êÁ†ÅÁöÑÁâàÊú¨ÊéßÂà∂„ÄÇ</p>
<p>exec ÊñπÂºè‰ºöË¢´Ëß£Êûê‰∏∫‰∏Ä‰∏™ JSON Êï∞ÁªÑÔºåÊâÄ‰ª•ÂøÖÈ°ª‰ΩøÁî®ÂèåÂºïÂè∑ËÄå‰∏çÊòØÂçïÂºïÂè∑„ÄÇexec ÊñπÂºè‰∏ç‰ºöË∞ÉÁî®‰∏Ä‰∏™ÂëΩ‰ª§ shellÔºåÊâÄ‰ª•‰πüÂ∞±‰∏ç‰ºöÁªßÊâøÁõ∏Â∫îÁöÑÂèòÈáèÔºåÂ¶ÇÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">RUN [ <span class="hljs-string">&quot;echo&quot;</span>, <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>&quot;</span> ]<br></code></pre></td></tr></table></figure>
<p>ËøôÁßçÊñπÂºèÊòØ‰∏ç‰ºöËææÂà∞ËæìÂá∫ HOME ÂèòÈáèÁöÑÔºåÊ≠£Á°ÆÁöÑÊñπÂºèÂ∫îËØ•ÊòØËøôÊ†∑ÁöÑ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">RUN [ <span class="hljs-string">&quot;sh&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>, <span class="hljs-string">&quot;echo&quot;</span>, <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>&quot;</span> ]<br></code></pre></td></tr></table></figure>
<p>RUN‰∫ßÁîüÁöÑÁºìÂ≠òÂú®‰∏ã‰∏ÄÊ¨°ÊûÑÂª∫ÁöÑÊó∂ÂÄôÊòØ‰∏ç‰ºöÂ§±ÊïàÁöÑÔºå‰ºöË¢´ÈáçÁî®ÔºåÂèØ‰ª•‰ΩøÁî®‚Äìno-cacheÈÄâÈ°πÔºåÂç≥docker build --no-cacheÔºåÂ¶ÇÊ≠§‰æø‰∏ç‰ºöÁºìÂ≠ò„ÄÇ</p>
<h2 id="7-3-CMD"><a class="header-anchor" href="#7-3-CMD"></a>7.3 CMD</h2>
<p>CMDÊúâ‰∏âÁßç‰ΩøÁî®ÊñπÂºè:</p>
<ul>
<li>CMD¬†<a target="_blank" rel="noopener" href="http://opskumu.github.io/exec%20form,%20this%20is%20the%20preferred%20form,%20%E4%BC%98%E5%85%88%E9%80%89%E6%8B%A9">‚Äúexecutable‚Äù,‚Äúparam1‚Äù,‚Äúparam2‚Äù</a></li>
<li>CMD¬†<a target="_blank" rel="noopener" href="http://opskumu.github.io/as%20default%20parameters%20to%20%60ENTRYPOINT%60">‚Äúparam1‚Äù,‚Äúparam2‚Äù</a></li>
<li>CMD command param1 param2 (shell form)</li>
</ul>
<p>CMDÊåáÂÆöÂú® Dockerfile ‰∏≠Âè™ËÉΩ‰ΩøÁî®‰∏ÄÊ¨°ÔºåÂ¶ÇÊûúÊúâÂ§ö‰∏™ÔºåÂàôÂè™ÊúâÊúÄÂêé‰∏Ä‰∏™‰ºöÁîüÊïà„ÄÇ</p>
<p>CMDÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂú®ÂêØÂä®ÂÆπÂô®Êó∂Êèê‰æõ‰∏Ä‰∏™ÈªòËÆ§ÁöÑÂëΩ‰ª§ÊâßË°åÈÄâÈ°π„ÄÇÂ¶ÇÊûúÁî®Êà∑ÂêØÂä®ÂÆπÂô®Êó∂ÊåáÂÆö‰∫ÜËøêË°åÁöÑÂëΩ‰ª§ÔºåÂàô‰ºöË¶ÜÁõñÊéâCMDÊåáÂÆöÁöÑÂëΩ‰ª§„ÄÇ</p>
<blockquote>
<p>CMD‰ºöÂú®ÂêØÂä®ÂÆπÂô®ÁöÑÊó∂ÂÄôÊâßË°åÔºåbuild Êó∂‰∏çÊâßË°åÔºåËÄåRUNÂè™ÊòØÂú®ÊûÑÂª∫ÈïúÂÉèÁöÑÊó∂ÂÄôÊâßË°åÔºåÂêéÁª≠ÈïúÂÉèÊûÑÂª∫ÂÆåÊàê‰πãÂêéÔºåÂêØÂä®ÂÆπÂô®Â∞±‰∏éRUNÊó†ÂÖ≥‰∫ÜÔºåËøô‰∏™ÂàùÂ≠¶ËÄÖÂÆπÊòìÂºÑÊ∑∑Ëøô‰∏™Ê¶ÇÂøµÔºåËøôÈáåÁÆÄÂçïÊ≥®Ëß£‰∏Ä‰∏ã„ÄÇ</p>
</blockquote>
<h2 id="7-4-EXPOSE"><a class="header-anchor" href="#7-4-EXPOSE"></a>7.4 EXPOSE</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">EXPOSE &lt;port&gt; [&lt;port&gt;...]<br></code></pre></td></tr></table></figure>
<p>ÂëäËØâ Docker ÊúçÂä°Á´ØÂÆπÂô®ÂØπÂ§ñÊò†Â∞ÑÁöÑÊú¨Âú∞Á´ØÂè£ÔºåÈúÄË¶ÅÂú® docker run ÁöÑÊó∂ÂÄô‰ΩøÁî®-pÊàñËÄÖ-PÈÄâÈ°πÁîüÊïà„ÄÇ</p>
<h2 id="7-5-ENV"><a class="header-anchor" href="#7-5-ENV"></a>7.5 ENV</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ENV &lt;key&gt; &lt;value&gt;       <span class="hljs-comment"># Âè™ËÉΩËÆæÁΩÆ‰∏Ä‰∏™ÂèòÈáè</span><br>ENV &lt;key&gt;=&lt;value&gt; ...   <span class="hljs-comment"># ÂÖÅËÆ∏‰∏ÄÊ¨°ËÆæÁΩÆÂ§ö‰∏™ÂèòÈáè</span><br></code></pre></td></tr></table></figure>
<p>ÊåáÂÆö‰∏Ä‰∏™ÁéØËäÇÂèòÈáèÔºå‰ºöË¢´ÂêéÁª≠RUNÊåá‰ª§‰ΩøÁî®ÔºåÂπ∂Âú®ÂÆπÂô®ËøêË°åÊó∂‰øùÁïô„ÄÇ</p>
<p>‰æãÂ≠ê:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ENV myName=<span class="hljs-string">&quot;John Doe&quot;</span> myDog=Rex\ The\ Dog \<br>    myCat=fluffy<br></code></pre></td></tr></table></figure>
<p>Á≠âÂêå‰∫é</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ENV myName John Doe<br>ENV myDog Rex The Dog<br>ENV myCat fluffy<br></code></pre></td></tr></table></figure>
<h2 id="7-6-ADD"><a class="header-anchor" href="#7-6-ADD"></a>7.6 ADD</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ADD &lt;src&gt;... &lt;dest&gt;<br></code></pre></td></tr></table></figure>
<p>ADDÂ§çÂà∂Êú¨Âú∞‰∏ªÊú∫Êñá‰ª∂„ÄÅÁõÆÂΩïÊàñËÄÖËøúÁ®ãÊñá‰ª∂ URLS ‰ªé Âπ∂‰∏îÊ∑ªÂä†Âà∞ÂÆπÂô®ÊåáÂÆöË∑ØÂæÑ‰∏≠ „ÄÇ</p>
<p>ÊîØÊåÅÈÄöËøá GO ÁöÑÊ≠£ÂàôÊ®°Á≥äÂåπÈÖçÔºåÂÖ∑‰ΩìËßÑÂàôÂèØÂèÇËßÅ¬†<a target="_blank" rel="noopener" href="http://golang.org/pkg/path/filepath/#Match">Go filepath.Match</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ADD hom* /mydir/        <span class="hljs-comment"># adds all files starting with &quot;hom&quot;</span><br>ADD hom?.txt /mydir/    <span class="hljs-comment"># ? is replaced with any single character</span><br></code></pre></td></tr></table></figure>
<ul>
<li>Ë∑ØÂæÑÂøÖÈ°ªÊòØÁªùÂØπË∑ØÂæÑÔºåÂ¶ÇÊûú ‰∏çÂ≠òÂú®Ôºå‰ºöËá™Âä®ÂàõÂª∫ÂØπÂ∫îÁõÆÂΩï</li>
<li>Ë∑ØÂæÑÂøÖÈ°ªÊòØ Dockerfile ÊâÄÂú®Ë∑ØÂæÑÁöÑÁõ∏ÂØπË∑ØÂæÑ</li>
<li>Â¶ÇÊûúÊòØ‰∏Ä‰∏™ÁõÆÂΩïÔºåÂè™‰ºöÂ§çÂà∂ÁõÆÂΩï‰∏ãÁöÑÂÜÖÂÆπÔºåËÄåÁõÆÂΩïÊú¨Ë∫´Âàô‰∏ç‰ºöË¢´Â§çÂà∂</li>
</ul>
<h2 id="7-7-COPY"><a class="header-anchor" href="#7-7-COPY"></a>7.7 COPY</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">COPY &lt;src&gt;... &lt;dest&gt;<br></code></pre></td></tr></table></figure>
<p>COPYÂ§çÂà∂Êñ∞Êñá‰ª∂ÊàñËÄÖÁõÆÂΩï‰ªé Âπ∂‰∏îÊ∑ªÂä†Âà∞ÂÆπÂô®ÊåáÂÆöË∑ØÂæÑ‰∏≠ „ÄÇÁî®Ê≥ïÂêåADDÔºåÂîØ‰∏ÄÁöÑ‰∏çÂêåÊòØ‰∏çËÉΩÊåáÂÆöËøúÁ®ãÊñá‰ª∂ URLS„ÄÇ</p>
<h2 id="7-8-ENTRYPOINT"><a class="header-anchor" href="#7-8-ENTRYPOINT"></a>7.8 ENTRYPOINT</h2>
<ul>
<li>ENTRYPOINT¬†<a target="_blank" rel="noopener" href="http://opskumu.github.io/the%20preferred%20exec%20form%EF%BC%8C%E4%BC%98%E5%85%88%E9%80%89%E6%8B%A9">‚Äúexecutable‚Äù, ‚Äúparam1‚Äù, ‚Äúparam2‚Äù</a></li>
<li>ENTRYPOINT command param1 param2 (shell form)</li>
</ul>
<p>ÈÖçÁΩÆÂÆπÂô®ÂêØÂä®ÂêéÊâßË°åÁöÑÂëΩ‰ª§ÔºåÂπ∂‰∏î‰∏çÂèØË¢´ docker run Êèê‰æõÁöÑÂèÇÊï∞Ë¶ÜÁõñÔºåËÄåCMDÊòØÂèØ‰ª•Ë¢´Ë¶ÜÁõñÁöÑ„ÄÇÂ¶ÇÊûúÈúÄË¶ÅË¶ÜÁõñÔºåÂàôÂèØ‰ª•‰ΩøÁî®docker run --entrypointÈÄâÈ°π„ÄÇ</p>
<p>ÊØè‰∏™ Dockerfile ‰∏≠Âè™ËÉΩÊúâ‰∏Ä‰∏™ENTRYPOINTÔºåÂΩìÊåáÂÆöÂ§ö‰∏™Êó∂ÔºåÂè™ÊúâÊúÄÂêé‰∏Ä‰∏™ÁîüÊïà„ÄÇ</p>
<h3 id="Exec-form-ENTRYPOINT-‰æãÂ≠ê"><a class="header-anchor" href="#Exec-form-ENTRYPOINT-‰æãÂ≠ê"></a>Exec form ENTRYPOINT ‰æãÂ≠ê</h3>
<p>ÈÄöËøáENTRYPOINT‰ΩøÁî® exec form ÊñπÂºèËÆæÁΩÆÁ®≥ÂÆöÁöÑÈªòËÆ§ÂëΩ‰ª§ÂíåÈÄâÈ°πÔºåËÄå‰ΩøÁî®CMDÊ∑ªÂä†ÈªòËÆ§‰πãÂ§ñÁªèÂ∏∏Ë¢´ÊîπÂä®ÁöÑÈÄâÈ°π„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM ubuntu<br>ENTRYPOINT [<span class="hljs-string">&quot;top&quot;</span>, <span class="hljs-string">&quot;-b&quot;</span>]<br>CMD [<span class="hljs-string">&quot;-c&quot;</span>]<br></code></pre></td></tr></table></figure>
<p>ÈÄöËøá Dockerfile ‰ΩøÁî®ENTRYPOINTÂ±ïÁ§∫ÂâçÂè∞ËøêË°å Apache ÊúçÂä°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM debian:stable<br>RUN apt-get update &amp;&amp; apt-get install -y --force-yes apache2<br>EXPOSE 80 443<br>VOLUME [<span class="hljs-string">&quot;/var/www&quot;</span>, <span class="hljs-string">&quot;/var/log/apache2&quot;</span>, <span class="hljs-string">&quot;/etc/apache2&quot;</span>]<br>ENTRYPOINT [<span class="hljs-string">&quot;/usr/sbin/apache2ctl&quot;</span>, <span class="hljs-string">&quot;-D&quot;</span>, <span class="hljs-string">&quot;FOREGROUND&quot;</span>]<br></code></pre></td></tr></table></figure>
<h3 id="Shell-form-ENTRYPOINT-‰æãÂ≠ê"><a class="header-anchor" href="#Shell-form-ENTRYPOINT-‰æãÂ≠ê"></a>Shell form ENTRYPOINT ‰æãÂ≠ê</h3>
<p>ËøôÁßçÊñπÂºè‰ºöÂú®/bin/sh -c‰∏≠ÊâßË°åÔºå‰ºöÂøΩÁï•‰ªª‰ΩïCMDÊàñËÄÖdocker runÂëΩ‰ª§Ë°åÈÄâÈ°πÔºå‰∏∫‰∫ÜÁ°Æ‰øùdocker stopËÉΩÂ§üÂÅúÊ≠¢ÈïøÊó∂Èó¥ËøêË°åENTRYPOINTÁöÑÂÆπÂô®ÔºåÁ°Æ‰øùÊâßË°åÁöÑÊó∂ÂÄô‰ΩøÁî®execÈÄâÈ°π„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM ubuntu<br>ENTRYPOINT <span class="hljs-built_in">exec</span> top -b<br></code></pre></td></tr></table></figure>
<p>Â¶ÇÊûúÂú®ENTRYPOINTÂøòËÆ∞‰ΩøÁî®execÈÄâÈ°πÔºåÂàôÂèØ‰ª•‰ΩøÁî®CMDË°•‰∏ä:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">FROM ubuntu<br>ENTRYPOINT top -b<br>CMD --ignored-param1 <span class="hljs-comment"># --ignored-param2 ... --ignored-param3 ... ‰æùÊ≠§Á±ªÊé®</span><br></code></pre></td></tr></table></figure>
<h2 id="7-9-VOLUME"><a class="header-anchor" href="#7-9-VOLUME"></a>7.9 VOLUME</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">VOLUME [<span class="hljs-string">&quot;/data&quot;</span>]<br></code></pre></td></tr></table></figure>
<p>ÂàõÂª∫‰∏Ä‰∏™ÂèØ‰ª•‰ªéÊú¨Âú∞‰∏ªÊú∫ÊàñÂÖ∂‰ªñÂÆπÂô®ÊåÇËΩΩÁöÑÊåÇËΩΩÁÇπÔºåÂêéÁª≠ÂÖ∑‰Ωì‰ªãÁªç„ÄÇ</p>
<h2 id="7-10-USER"><a class="header-anchor" href="#7-10-USER"></a>7.10 USER</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">USER daemon<br></code></pre></td></tr></table></figure>
<p>ÊåáÂÆöËøêË°åÂÆπÂô®Êó∂ÁöÑÁî®Êà∑ÂêçÊàñ UIDÔºåÂêéÁª≠ÁöÑRUN„ÄÅCMD„ÄÅENTRYPOINT‰πü‰ºö‰ΩøÁî®ÊåáÂÆöÁî®Êà∑„ÄÇ</p>
<h2 id="7-11-WORKDIR"><a class="header-anchor" href="#7-11-WORKDIR"></a>7.11 WORKDIR</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">WORKDIR /path/to/workdir<br></code></pre></td></tr></table></figure>
<p>‰∏∫ÂêéÁª≠ÁöÑRUN„ÄÅCMD„ÄÅENTRYPOINTÊåá‰ª§ÈÖçÁΩÆÂ∑•‰ΩúÁõÆÂΩï„ÄÇÂèØ‰ª•‰ΩøÁî®Â§ö‰∏™WORKDIRÊåá‰ª§ÔºåÂêéÁª≠ÂëΩ‰ª§Â¶ÇÊûúÂèÇÊï∞ÊòØÁõ∏ÂØπË∑ØÂæÑÔºåÂàô‰ºöÂü∫‰∫é‰πãÂâçÂëΩ‰ª§ÊåáÂÆöÁöÑË∑ØÂæÑ„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">WORKDIR /a<br>WORKDIR b<br>WORKDIR c<br>RUN <span class="hljs-built_in">pwd</span><br></code></pre></td></tr></table></figure>
<p>ÊúÄÁªàË∑ØÂæÑÊòØ/a/b/c„ÄÇ</p>
<p>WORKDIRÊåá‰ª§ÂèØ‰ª•Âú®ENVËÆæÁΩÆÂèòÈáè‰πãÂêéË∞ÉÁî®ÁéØÂ¢ÉÂèòÈáè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ENV DIRPATH /path<br>WORKDIR <span class="hljs-variable">$DIRPATH</span>/<span class="hljs-variable">$DIRNAME</span><br></code></pre></td></tr></table></figure>
<p>ÊúÄÁªàË∑ØÂæÑÂàô‰∏∫ /path/$DIRNAME„ÄÇ</p>
<h2 id="7-12-ONBUILD"><a class="header-anchor" href="#7-12-ONBUILD"></a>7.12 ONBUILD</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ONBUILD [INSTRUCTION]<br></code></pre></td></tr></table></figure>
<p>ÈÖçÁΩÆÂΩìÊâÄÂàõÂª∫ÁöÑÈïúÂÉè‰Ωú‰∏∫ÂÖ∂ÂÆÉÊñ∞ÂàõÂª∫ÈïúÂÉèÁöÑÂü∫Á°ÄÈïúÂÉèÊó∂ÔºåÊâÄÊâßË°åÁöÑÊìç‰ΩúÊåá‰ª§„ÄÇ</p>
<p>‰æãÂ¶ÇÔºåDockerfile ‰ΩøÁî®Â¶Ç‰∏ãÁöÑÂÜÖÂÆπÂàõÂª∫‰∫ÜÈïúÂÉè image-AÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[...]<br>ONBUILD ADD . /app/src<br>ONBUILD RUN /usr/local/bin/python-build --<span class="hljs-built_in">dir</span> /app/src<br>[...]<br></code></pre></td></tr></table></figure>
<p>Â¶ÇÊûúÂü∫‰∫é image-A ÂàõÂª∫Êñ∞ÁöÑÈïúÂÉèÊó∂ÔºåÊñ∞ÁöÑ Dockerfile ‰∏≠‰ΩøÁî® FROM image-A ÊåáÂÆöÂü∫Á°ÄÈïúÂÉèÊó∂Ôºå‰ºöËá™Âä®ÊâßË°å ONBUILD Êåá‰ª§ÂÜÖÂÆπÔºåÁ≠â‰ª∑‰∫éÂú®ÂêéÈù¢Ê∑ªÂä†‰∫Ü‰∏§Êù°Êåá‰ª§„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Automatically run the following</span><br>ADD . /app/src<br>RUN /usr/local/bin/python-build --<span class="hljs-built_in">dir</span> /app/src<br></code></pre></td></tr></table></figure>
<p>‰ΩøÁî®ONBUILDÊåá‰ª§ÁöÑÈïúÂÉèÔºåÊé®ËçêÂú®Ê†áÁ≠æ‰∏≠Ê≥®ÊòéÔºå‰æãÂ¶Ç ruby:1.9-onbuild„ÄÇ</p>
<h2 id="7-13-Dockerfile-Examples"><a class="header-anchor" href="#7-13-Dockerfile-Examples"></a>7.13 Dockerfile Examples</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Nginx</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># VERSION               0.0.1</span><br>FROM      ubuntu<br>MAINTAINER Victor Vieux &lt;victor@docker.com&gt;<br>RUN apt-get update &amp;&amp; apt-get install -y inotify-tools nginx apache2 openssh-server<br>  <br><span class="hljs-comment"># Firefox over VNC</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># VERSION               0.3</span><br>FROM ubuntu<br><span class="hljs-comment"># Install vnc, xvfb in order to create a &#x27;fake&#x27; display and firefox</span><br>RUN apt-get update &amp;&amp; apt-get install -y x11vnc xvfb firefox<br>RUN <span class="hljs-built_in">mkdir</span> ~/.vnc<br><span class="hljs-comment"># Setup a password</span><br>RUN x11vnc -storepasswd 1234 ~/.vnc/passwd<br><span class="hljs-comment"># Autostart firefox (might not be the best way, but it does the trick)</span><br>RUN bash -c <span class="hljs-string">&#x27;echo &quot;firefox&quot; &gt;&gt; /.bashrc&#x27;</span><br>EXPOSE 5900<br>CMD    [<span class="hljs-string">&quot;x11vnc&quot;</span>, <span class="hljs-string">&quot;-forever&quot;</span>, <span class="hljs-string">&quot;-usepw&quot;</span>, <span class="hljs-string">&quot;-create&quot;</span>]<br>  <br><span class="hljs-comment"># Multiple images example</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># VERSION               0.1</span><br>FROM ubuntu<br>RUN <span class="hljs-built_in">echo</span> foo &gt; bar<br><span class="hljs-comment"># Will output something like ===&gt; 907ad6c2736f</span><br>FROM ubuntu<br>RUN <span class="hljs-built_in">echo</span> moo &gt; oink<br><span class="hljs-comment"># Will output something like ===&gt; 695d7793cbe4</span><br> <br><span class="hljs-comment"># You·æøll now have two images, 907ad6c2736f with /bar, and 695d7793cbe4 with</span><br><span class="hljs-comment"># /oink.</span><br></code></pre></td></tr></table></figure>
<h2 id="7-14-docker-build"><a class="header-anchor" href="#7-14-docker-build"></a>7.14 docker build</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker build --<span class="hljs-built_in">help</span><br>Usage: docker build [OPTIONS] PATH | URL | -<br>Build a new image from the <span class="hljs-built_in">source</span> code at PATH<br>  --force-rm=<span class="hljs-literal">false</span>     Always remove intermediate containers, even after unsuccessful builds <span class="hljs-comment"># ÁßªÈô§ËøáÊ∏°ÂÆπÂô®ÔºåÂç≥‰ΩøÊûÑÂª∫Â§±Ë¥•</span><br>  --no-cache=<span class="hljs-literal">false</span>     Do not use cache when building the image                              <span class="hljs-comment"># ‰∏çÂÆûÁî® cache        </span><br>  -q, --quiet=<span class="hljs-literal">false</span>    Suppress the verbose output generated by the containers               <br>  --<span class="hljs-built_in">rm</span>=<span class="hljs-literal">true</span>            Remove intermediate containers after a successful build               <span class="hljs-comment"># ÊûÑÂª∫ÊàêÂäüÂêéÁßªÈô§ËøáÊ∏°Â±ÇÂÆπÂô®</span><br>  -t, --tag=<span class="hljs-string">&quot;&quot;</span>         Repository name (and optionally a tag) to be applied to the resulting image <span class="hljs-keyword">in</span> <span class="hljs-keyword">case</span> of success<br></code></pre></td></tr></table></figure>
<p>ÂèÇËÄÉÊñáÊ°£:<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/builder/">Dockerfile Reference</a></p>
<h2 id="7-15-dockerfile-ÊúÄ‰Ω≥ÂÆûË∑µ"><a class="header-anchor" href="#7-15-dockerfile-ÊúÄ‰Ω≥ÂÆûË∑µ"></a>7.15 dockerfile ÊúÄ‰Ω≥ÂÆûË∑µ</h2>
<ul>
<li>‰ΩøÁî®.dockerignoreÊñá‰ª∂</li>
</ul>
<p>‰∏∫‰∫ÜÂú®docker buildËøáÁ®ã‰∏≠Êõ¥Âø´‰∏ä‰º†ÂíåÊõ¥Âä†È´òÊïàÔºåÂ∫îËØ•‰ΩøÁî®‰∏Ä‰∏™.dockerignoreÊñá‰ª∂Áî®Êù•ÊéíÈô§ÊûÑÂª∫ÈïúÂÉèÊó∂‰∏çÈúÄË¶ÅÁöÑÊñá‰ª∂ÊàñÁõÆÂΩï„ÄÇ‰æãÂ¶Ç,Èô§Èùû.gitÂú®ÊûÑÂª∫ËøáÁ®ã‰∏≠ÈúÄË¶ÅÁî®Âà∞ÔºåÂê¶Âàô‰Ω†Â∫îËØ•Â∞ÜÂÆÉÊ∑ªÂä†Âà∞.dockerignoreÊñá‰ª∂‰∏≠ÔºåËøôÊ†∑ÂèØ‰ª•ËäÇÁúÅÂæàÂ§öÊó∂Èó¥„ÄÇ</p>
<ul>
<li>ÈÅøÂÖçÂÆâË£Ö‰∏çÂøÖË¶ÅÁöÑËΩØ‰ª∂ÂåÖ</li>
</ul>
<p>‰∏∫‰∫ÜÈôç‰ΩéÂ§çÊùÇÊÄß„ÄÅ‰æùËµñÊÄß„ÄÅÊñá‰ª∂Â§ßÂ∞è‰ª•ÂèäÊûÑÂª∫Êó∂Èó¥ÔºåÂ∫îËØ•ÈÅøÂÖçÂÆâË£ÖÈ¢ùÂ§ñÁöÑÊàñ‰∏çÂøÖË¶ÅÁöÑÂåÖ„ÄÇ‰æãÂ¶ÇÔºå‰∏çÈúÄË¶ÅÂú®‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÈïúÂÉè‰∏≠ÂÆâË£Ö‰∏Ä‰∏™ÊñáÊú¨ÁºñËæëÂô®„ÄÇ</p>
<ul>
<li>ÊØè‰∏™ÂÆπÂô®ÈÉΩË∑ë‰∏Ä‰∏™ËøõÁ®ã</li>
</ul>
<p>Âú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºå‰∏Ä‰∏™ÂÆπÂô®Â∫îËØ•Âè™ÂçïÁã¨Ë∑ë‰∏Ä‰∏™Á®ãÂ∫è„ÄÇËß£ËÄ¶Â∫îÁî®Âà∞Â§ö‰∏™ÂÆπÂô®‰ΩøÂÖ∂Êõ¥ÂÆπÊòìÊ®™ÂêëÊâ©Â±ïÂíåÈáçÁî®„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÊúçÂä°‰æùËµñÂè¶Â§ñ‰∏Ä‰∏™ÊúçÂä°ÔºåÂèØ‰ª•ÂèÇËÄÉ¬†<a target="_blank" rel="noopener" href="https://docs.docker.com/userguide/dockerlinks/">Linking Containers Together</a>„ÄÇ</p>
<ul>
<li>ÊúÄÂ∞èÂåñÂ±Ç</li>
</ul>
<p>Êàë‰ª¨Áü•ÈÅìÊØèÊâßË°å‰∏Ä‰∏™Êåá‰ª§ÔºåÈÉΩ‰ºöÊúâ‰∏ÄÊ¨°ÈïúÂÉèÁöÑÊèê‰∫§ÔºåÈïúÂÉèÊòØÂàÜÂ±ÇÁöÑÁªìÊûÑÔºåÂØπ‰∫éDockerfileÔºåÂ∫îËØ•ÊâæÂà∞ÂèØËØªÊÄßÂíåÊúÄÂ∞èÂåñÂ±Ç‰πãÈó¥ÁöÑÂπ≥Ë°°„ÄÇ</p>
<ul>
<li>Â§öË°åÂèÇÊï∞ÊéíÂ∫è</li>
</ul>
<p>Â¶ÇÊûúÂèØËÉΩÔºåÈÄöËøáÂ≠óÊØçÈ°∫Â∫èÊù•ÊéíÂ∫èÔºåËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÂÆâË£ÖÂåÖÁöÑÈáçÂ§çÂπ∂‰∏îÊõ¥ÂÆπÊòìÊõ¥Êñ∞ÂàóË°®ÔºåÂè¶Â§ñÂèØËØªÊÄß‰πü‰ºöÊõ¥Âº∫ÔºåÊ∑ªÂä†‰∏Ä‰∏™Á©∫Ë°å‰ΩøÁî®\Êç¢Ë°å:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">RUN apt-get update &amp;&amp; apt-get install -y \<br>  bzr \<br>  cvs \<br>  git \<br>  mercurial \<br>  subversion<br></code></pre></td></tr></table></figure>
<ul>
<li>ÂàõÂª∫ÁºìÂ≠ò</li>
</ul>
<p>ÈïúÂÉèÊûÑÂª∫ËøáÁ®ã‰∏≠‰ºöÊåâÁÖßDockerfileÁöÑÈ°∫Â∫è‰æùÊ¨°ÊâßË°åÔºåÊØèÊâßË°å‰∏ÄÊ¨°Êåá‰ª§ Docker ‰ºöÂØªÊâæÊòØÂê¶ÊúâÂ≠òÂú®ÁöÑÈïúÂÉèÁºìÂ≠òÂèØÂ§çÁî®ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàôÂàõÂª∫Êñ∞ÁöÑÈïúÂÉè„ÄÇÂ¶ÇÊûú‰∏çÊÉ≥‰ΩøÁî®ÁºìÂ≠òÔºåÂàôÂèØ‰ª•Âú®docker buildÊó∂Ê∑ªÂä†‚Äìno-cache=trueÈÄâÈ°π„ÄÇ</p>
<p>‰ªéÂü∫Á°ÄÈïúÂÉèÂºÄÂßãÂ∞±Â∑≤ÁªèÂú®ÁºìÂ≠ò‰∏≠‰∫ÜÔºå‰∏ã‰∏Ä‰∏™Êåá‰ª§‰ºöÂØπÊØîÊâÄÊúâÁöÑÂ≠êÈïúÂÉèÂØªÊâæÊòØÂê¶ÊâßË°åÁõ∏ÂêåÁöÑÊåá‰ª§ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàôÁºìÂ≠òÂ§±Êïà„ÄÇÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÂè™ÂØπÊØîDockerfileÊåá‰ª§ÂíåÂ≠êÈïúÂÉèÂ∞±Ë∂≥Â§ü‰∫Ü„ÄÇADDÂíåCOPYÊåá‰ª§Èô§Â§ñÔºåÊâßË°åADDÂíåCOPYÊó∂Â≠òÊîæÂà∞ÈïúÂÉèÁöÑÊñá‰ª∂‰πüÊòØÈúÄË¶ÅÊ£ÄÊü•ÁöÑÔºåÂÆåÊàê‰∏Ä‰∏™Êñá‰ª∂ÁöÑÊ†°È™å‰πãÂêéÂÜçÂà©Áî®Ëøô‰∏™Ê†°È™åÂú®ÁºìÂ≠ò‰∏≠Êü•ÊâæÔºåÂ¶ÇÊûúÊ£ÄÊµãÁöÑÊñá‰ª∂ÊîπÂèòÂàôÁºìÂ≠òÂ§±Êïà„ÄÇRUN apt-get -y updateÂëΩ‰ª§Âè™Ê£ÄÊü•ÂëΩ‰ª§ÊòØÂê¶ÂåπÈÖçÔºåÂ¶ÇÊûúÂåπÈÖçÂ∞±‰∏ç‰ºöÂÜçÊâßË°åÊõ¥Êñ∞‰∫Ü„ÄÇ</p>
<blockquote>
<p>‰∏∫‰∫ÜÊúâÊïàÂú∞Âà©Áî®ÁºìÂ≠òÔºå‰Ω†ÈúÄË¶Å‰øùÊåÅ‰Ω†ÁöÑ Dockerfile ‰∏ÄËá¥ÔºåÂπ∂‰∏îÂ∞ΩÈáèÂú®Êú´Â∞æ‰øÆÊîπ„ÄÇ</p>
</blockquote>
<h3 id="Dockerfile-Êåá‰ª§"><a class="header-anchor" href="#Dockerfile-Êåá‰ª§"></a>Dockerfile Êåá‰ª§</h3>
<ul>
<li>FROM: Âè™Ë¶ÅÂèØËÉΩÂ∞±‰ΩøÁî®ÂÆòÊñπÈïúÂÉèÂ∫ì‰Ωú‰∏∫Âü∫Á°ÄÈïúÂÉè</li>
<li>RUN: ‰∏∫‰øùÊåÅÂèØËØªÊÄß„ÄÅÊñπ‰æøÁêÜËß£„ÄÅÂèØÁª¥Êä§ÊÄßÔºåÊääÈïøÊàñËÄÖÂ§çÊùÇÁöÑRUNËØ≠Âè•‰ΩøÁî®\ÂàÜÈöîÁ¨¶ÂàÜÊàêÂ§öË°å
<ul>
<li>‰∏çÂª∫ËÆÆRUN apt-get updateÁã¨Á´ãÊàêË°åÔºåÂê¶ÂàôÂ¶ÇÊûúÂêéÁª≠ÂåÖÊúâÊõ¥Êñ∞ÔºåÈÇ£‰πà‰πü‰∏ç‰ºöÂÜçÊâßË°åÊõ¥Êñ∞</li>
<li>ÈÅøÂÖç‰ΩøÁî®RUN apt-get upgradeÊàñËÄÖdist-upgradeÔºåÂæàÂ§öÂøÖË¶ÅÁöÑÂåÖÂú®‰∏Ä‰∏™ÈùûprivilegedÊùÉÈôêÁöÑÂÆπÂô®ÈáåÊòØÊó†Ê≥ïÂçáÁ∫ßÁöÑ„ÄÇÂ¶ÇÊûúÁü•ÈÅìÊüê‰∏™ÂåÖÊõ¥Êñ∞Ôºå‰ΩøÁî®apt-get install -y xxx</li>
<li>Ê†áÂáÜÂÜôÊ≥ï
<ul>
<li>RUN apt-get update &amp;&amp; apt-get install -y package-bar package-foo</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>‰æãÂ≠ê:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">RUN apt-get update &amp;&amp; apt-get install -y \<br>    aufs-tools \<br>    automake \<br>    btrfs-tools \<br>    build-essential \<br>    curl \<br>    dpkg-sig \<br>    git \<br>    iptables \<br>    libapparmor-dev \<br>    libcap-dev \<br>    libsqlite3-dev \<br>    lxc=1.0* \<br>    mercurial \<br>    parallel \<br>    reprepro \<br>    ruby1.9.1 \<br>    ruby1.9.1-dev \<br>    s3cmd=1.1.0*<br></code></pre></td></tr></table></figure>
<ul>
<li>CMD: Êé®Ëçê‰ΩøÁî®CMD [‚Äúexecutable‚Äù, ‚Äúparam1‚Äù, ‚Äúparam2‚Äù‚Ä¶]ËøôÁßçÊ†ºÂºèÔºåCMD [‚Äúparam‚Äù, ‚Äúparam‚Äù]ÂàôÈÖçÂêàENTRYPOINT‰ΩøÁî®</li>
<li>EXPOSE: Dockerfile ÊåáÂÆöË¶ÅÂÖ¨ÂºÄÁöÑÁ´ØÂè£Ôºå‰ΩøÁî®docker runÊó∂ÊåáÂÆöÊò†Â∞ÑÂà∞ÂÆø‰∏ªÊú∫ÁöÑÁ´ØÂè£Âç≥ÂèØ</li>
<li>ENV: ‰∏∫‰∫Ü‰ΩøÊñ∞ÁöÑËΩØ‰ª∂Êõ¥ÂÆπÊòìËøêË°åÔºåÂèØ‰ª•‰ΩøÁî®ENVÊõ¥Êñ∞PATHÂèòÈáè„ÄÇÂ¶ÇENV PATH /usr/local/nginx/bin:$PATHÁ°Æ‰øùCMD [‚Äúnginx‚Äù]Âç≥ÂèØËøêË°å</li>
</ul>
<p>ENV‰πüÂèØ‰ª•ËøôÊ†∑ÂÆö‰πâÂèòÈáèÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">ENV PG_MAJOR 9.3<br>ENV PG_VERSION 9.3.4<br>RUN curl -SL http://example.com/postgres-<span class="hljs-variable">$PG_VERSION</span>.tar.xz | tar -xJC /usr/src/postgress &amp;&amp; ‚Ä¶<br>ENV PATH /usr/local/postgres-<span class="hljs-variable">$PG_MAJOR</span>/bin:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure>
<ul>
<li>ADDorCOPY:ADDÊØîCOPYÂ§ö‰∏Ä‰∫õÁâπÊÄß„Äåtar Êñá‰ª∂Ëá™Âä®Ëß£ÂåÖÂíåÊîØÊåÅËøúÁ®ã URL„ÄçÔºå‰∏çÊé®ËçêÊ∑ªÂä†ËøúÁ®ã URL</li>
</ul>
<p>Â¶Ç‰∏çÊé®ËçêËøôÁßçÊñπÂºè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ADD http://example.com/big.tar.xz /usr/src/things/<br>RUN tar -xJf /usr/src/things/big.tar.xz -C /usr/src/things<br>RUN make -C /usr/src/things all<br></code></pre></td></tr></table></figure>
<p>Êé®Ëçê‰ΩøÁî® curl ÊàñËÄÖ wget ÊõøÊç¢Ôºå‰ΩøÁî®Â¶Ç‰∏ãÊñπÂºè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">RUN <span class="hljs-built_in">mkdir</span> -p /usr/src/things \<br>    &amp;&amp; curl -SL http://example.com/big.tar.gz \<br>    | tar -xJC /usr/src/things \<br>    &amp;&amp; make -C /usr/src/things all<br></code></pre></td></tr></table></figure>
<p>Â¶ÇÊûú‰∏çÈúÄË¶ÅÊ∑ªÂä† tar Êñá‰ª∂ÔºåÊé®Ëçê‰ΩøÁî®COPY„ÄÇ</p>
<p>ÂèÇËÄÉÊñáÊ°£:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/articles/dockerfile_best-practices/">Best practices for writing Dockerfiles</a></li>
<li><a target="_blank" rel="noopener" href="http://dockerone.com/article/131">DockerfileÊúÄ‰Ω≥ÂÆûË∑µÔºà‰∏ÄÔºâ</a></li>
<li><a target="_blank" rel="noopener" href="http://dockerone.com/article/132">DockerfileÊúÄ‰Ω≥ÂÆûË∑µÔºà‰∫åÔºâ</a></li>
</ul>
<h1 id="ÂÖ´„ÄÅÂÆπÂô®Êï∞ÊçÆÁÆ°ÁêÜ"><a class="header-anchor" href="#ÂÖ´„ÄÅÂÆπÂô®Êï∞ÊçÆÁÆ°ÁêÜ"></a>ÂÖ´„ÄÅÂÆπÂô®Êï∞ÊçÆÁÆ°ÁêÜ</h1>
<p>dockerÁÆ°ÁêÜÊï∞ÊçÆÁöÑÊñπÂºèÊúâ‰∏§ÁßçÔºö</p>
<ul>
<li>Êï∞ÊçÆÂç∑</li>
<li>Êï∞ÊçÆÂç∑ÂÆπÂô®</li>
</ul>
<h2 id="8-1-Êï∞ÊçÆÂç∑"><a class="header-anchor" href="#8-1-Êï∞ÊçÆÂç∑"></a>8.1 Êï∞ÊçÆÂç∑</h2>
<p>Êï∞ÊçÆÂç∑ÊòØ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂÆπÂô®‰∏ìÈó®ÊåáÂÆöÁªïËøáUnion File SystemÁöÑÁõÆÂΩïÔºå‰∏∫ÊåÅÁª≠ÊÄßÊàñÂÖ±‰∫´Êï∞ÊçÆÊèê‰æõ‰∏Ä‰∫õÊúâÁî®ÁöÑÂäüËÉΩÔºö</p>
<ul>
<li>Êï∞ÊçÆÂç∑ÂèØ‰ª•Âú®ÂÆπÂô®Èó¥ÂÖ±‰∫´ÂíåÈáçÁî®</li>
<li>Êï∞ÊçÆÂç∑Êï∞ÊçÆÊîπÂèòÊòØÁõ¥Êé•‰øÆÊîπÁöÑ</li>
<li>Êï∞ÊçÆÂç∑Êï∞ÊçÆÊîπÂèò‰∏ç‰ºöË¢´ÂåÖÊã¨Âú®ÂÆπÂô®‰∏≠</li>
<li>Êï∞ÊçÆÂç∑ÊòØÊåÅÁª≠ÊÄßÁöÑÔºåÁõ¥Âà∞Ê≤°ÊúâÂÆπÂô®‰ΩøÁî®ÂÆÉ‰ª¨</li>
</ul>
<h3 id="Ê∑ªÂä†‰∏Ä‰∏™Êï∞ÊçÆÂç∑"><a class="header-anchor" href="#Ê∑ªÂä†‰∏Ä‰∏™Êï∞ÊçÆÂç∑"></a>Ê∑ªÂä†‰∏Ä‰∏™Êï∞ÊçÆÂç∑</h3>
<p>‰Ω†ÂèØ‰ª•‰ΩøÁî®-vÈÄâÈ°πÊ∑ªÂä†‰∏Ä‰∏™Êï∞ÊçÆÂç∑ÔºåÊàñËÄÖÂèØ‰ª•‰ΩøÁî®Â§öÊ¨°-vÈÄâÈ°π‰∏∫‰∏Ä‰∏™ docker ÂÆπÂô®ËøêË°åÊåÇËΩΩÂ§ö‰∏™Êï∞ÊçÆÂç∑„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --name data -v /data -t -i ubuntu:14.04 /bin/bash <span class="hljs-comment"># ÂàõÂª∫Êï∞ÊçÆÂç∑ÁªëÂÆöÂà∞Âà∞Êñ∞Âª∫ÂÆπÂô®ÔºåÊñ∞Âª∫ÂÆπÂô®‰∏≠‰ºöÂàõÂª∫ /data Êï∞ÊçÆÂç∑ bash-4.1# ls -ld /data/</span><br>drwxr-xr-x 2 root root 4096 Jul 23 06:59 /data/<br>bash-4.1<span class="hljs-comment"># df -Th</span><br>Filesystem    Type    Size  Used Avail Use% Mounted on<br>... ...<br>              ext4     91G  4.6G   82G   6% /data<br></code></pre></td></tr></table></figure>
<p>ÂàõÂª∫ÁöÑÊï∞ÊçÆÂç∑ÂèØ‰ª•ÈÄöËøádocker inspectËé∑ÂèñÂÆø‰∏ªÊú∫ÂØπÂ∫îË∑ØÂæÑ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker inspect data<br>... ... <span class="hljs-string">&quot;Volumes&quot;</span>: &#123; <span class="hljs-string">&quot;/data&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/vfs/dir/151de401d268226f96d824fdf444e77a4500aed74c495de5980c807a2ffb7ea9&quot;</span> &#125;, <span class="hljs-comment"># ÂèØ‰ª•ÁúãÂà∞ÂàõÂª∫ÁöÑÊï∞ÊçÆÂç∑ÂÆø‰∏ªÊú∫Ë∑ØÂæÑ ... ...</span><br></code></pre></td></tr></table></figure>
<p>ÊàñËÄÖÁõ¥Êé•ÊåáÂÆöËé∑Âèñ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker inspect --format=<span class="hljs-string">&quot;&#123;&#123; .Volumes &#125;&#125;&quot;</span> data<br>map[/data: /var/lib/docker/vfs/dir/151de401d268226f96d824fdf444e77a4500aed74c495de5980c807a2ffb7ea9]<br></code></pre></td></tr></table></figure>
<h3 id="ÊåÇËΩΩÂÆø‰∏ªÊú∫ÁõÆÂΩï‰∏∫‰∏Ä‰∏™Êï∞ÊçÆÂç∑"><a class="header-anchor" href="#ÊåÇËΩΩÂÆø‰∏ªÊú∫ÁõÆÂΩï‰∏∫‰∏Ä‰∏™Êï∞ÊçÆÂç∑"></a>ÊåÇËΩΩÂÆø‰∏ªÊú∫ÁõÆÂΩï‰∏∫‰∏Ä‰∏™Êï∞ÊçÆÂç∑</h3>
<p>-vÈÄâÈ°πÈô§‰∫ÜÂèØ‰ª•ÂàõÂª∫Âç∑Ôºå‰πüÂèØ‰ª•ÊåÇËΩΩÂΩìÂâç‰∏ªÊú∫ÁöÑ‰∏Ä‰∏™ÁõÆÂΩïÂà∞ÂÆπÂô®‰∏≠„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --name web -v /source/:/web -t -i ubuntu:14.04 /bin/bash<br>bash-4.1<span class="hljs-comment"># ls -ld /web/</span><br>drwxr-xr-x 2 root root 4096 Jul 23 06:59 /web/<br>bash-4.1<span class="hljs-comment"># df -Th</span><br>... ...<br>              ext4     91G  4.6G   82G   6% /web<br>bash-4.1<span class="hljs-comment"># exit </span><br></code></pre></td></tr></table></figure>
<p>ÈªòËÆ§ÊåÇËΩΩÂç∑ÊòØÂèØËØªÂÜôÁöÑÔºåÂèØ‰ª•Âú®ÊåÇËΩΩÊó∂ÊåáÂÆöÂè™ËØª</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --<span class="hljs-built_in">rm</span> --name <span class="hljs-built_in">test</span> -v /source/:/test:ro -t -i ubuntu:14.04 /bin/bash<br></code></pre></td></tr></table></figure>
<h2 id="8-2-ÂàõÂª∫ÂíåÊåÇËΩΩ‰∏Ä‰∏™Êï∞ÊçÆÂç∑ÂÆπÂô®"><a class="header-anchor" href="#8-2-ÂàõÂª∫ÂíåÊåÇËΩΩ‰∏Ä‰∏™Êï∞ÊçÆÂç∑ÂÆπÂô®"></a>8.2 ÂàõÂª∫ÂíåÊåÇËΩΩ‰∏Ä‰∏™Êï∞ÊçÆÂç∑ÂÆπÂô®</h2>
<p>Â¶ÇÊûú‰Ω†Êúâ‰∏Ä‰∫õÊåÅ‰πÖÊÄßÁöÑÊï∞ÊçÆÂπ∂‰∏îÊÉ≥Âú®ÂÆπÂô®Èó¥ÂÖ±‰∫´ÔºåÊàñËÄÖÊÉ≥Áî®Âú®ÈùûÊåÅ‰πÖÊÄßÁöÑÂÆπÂô®‰∏äÔºåÊúÄÂ•ΩÁöÑÊñπÊ≥ïÊòØÂàõÂª∫‰∏Ä‰∏™Êï∞ÊçÆÂç∑ÂÆπÂô®ÔºåÁÑ∂Âêé‰ªéÊ≠§ÂÆπÂô®‰∏äÊåÇËΩΩÊï∞ÊçÆ„ÄÇ</p>
<p>ÂàõÂª∫Êï∞ÊçÆÂç∑ÂÆπÂô®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i -d -v /test --name <span class="hljs-built_in">test</span> ubuntu:14.04 <span class="hljs-built_in">echo</span> hello<br></code></pre></td></tr></table></figure>
<p>‰ΩøÁî®‚Äìvolumes-fromÈÄâÈ°πÂú®Âè¶‰∏Ä‰∏™ÂÆπÂô®‰∏≠ÊåÇËΩΩ /test Âç∑„ÄÇ‰∏çÁÆ° test ÂÆπÂô®ÊòØÂê¶ËøêË°åÔºåÂÖ∂ÂÆÉÂÆπÂô®ÈÉΩÂèØ‰ª•ÊåÇËΩΩËØ•ÂÆπÂô®Êï∞ÊçÆÂç∑ÔºåÂΩìÁÑ∂Â¶ÇÊûúÂè™ÊòØÂçïÁã¨ÁöÑÊï∞ÊçÆÂç∑ÊòØÊ≤°ÂøÖË¶ÅËøêË°åÂÆπÂô®ÁöÑ„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i -d --volumes-from <span class="hljs-built_in">test</span> --name test1 ubuntu:14.04 /bin/bash<br></code></pre></td></tr></table></figure>
<p>Ê∑ªÂä†Âè¶‰∏Ä‰∏™ÂÆπÂô®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i -d --volumes-from <span class="hljs-built_in">test</span> --name test2 ubuntu:14.04 /bin/bash<br></code></pre></td></tr></table></figure>
<p>‰πüÂèØ‰ª•ÁªßÊâøÂÖ∂ÂÆÉÊåÇËΩΩÊúâ /test Âç∑ÁöÑÂÆπÂô®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i -d --volumes-from test1 --name test3 ubuntu:14.04 /bin/bash<br></code></pre></td></tr></table></figure>
<p><img src="http://static.open-open.com/lib/uploadImg/20150212/20150212091035_912.png" srcset="/img/loading.gif" lazyload alt="ÈùûÂ∏∏ËØ¶ÁªÜÁöÑ Docker Â≠¶‰π†Á¨îËÆ∞"></p>
<h2 id="8-3-Â§á‰ªΩ„ÄÅÊÅ¢Â§çÊàñËøÅÁßªÊï∞ÊçÆÂç∑"><a class="header-anchor" href="#8-3-Â§á‰ªΩ„ÄÅÊÅ¢Â§çÊàñËøÅÁßªÊï∞ÊçÆÂç∑"></a>8.3 Â§á‰ªΩ„ÄÅÊÅ¢Â§çÊàñËøÅÁßªÊï∞ÊçÆÂç∑</h2>
<h3 id="Â§á‰ªΩ"><a class="header-anchor" href="#Â§á‰ªΩ"></a>Â§á‰ªΩ</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --<span class="hljs-built_in">rm</span> --volumes-from <span class="hljs-built_in">test</span> -v $(<span class="hljs-built_in">pwd</span>):/backup ubuntu:14.04 tar cvf /backup/test.tar /test<br>tar: Removing leading `/<span class="hljs-string">&#x27; from member names</span><br><span class="hljs-string">/test/</span><br><span class="hljs-string">/test/b</span><br><span class="hljs-string">/test/d</span><br><span class="hljs-string">/test/c</span><br><span class="hljs-string">/test/a</span><br></code></pre></td></tr></table></figure>
<p>ÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑÂÆπÂô®Âπ∂‰∏î‰ªétestÂÆπÂô®‰∏≠ÊåÇËΩΩÂç∑ÔºåÁÑ∂ÂêéÊåÇËΩΩÂΩìÂâçÁõÆÂΩïÂà∞ÂÆπÂô®‰∏≠‰∏∫ backupÔºåÂπ∂Â§á‰ªΩ test Âç∑‰∏≠ÊâÄÊúâÁöÑÊï∞ÊçÆ‰∏∫ test.tarÔºåÊâßË°åÂÆåÊàê‰πãÂêéÂà†Èô§ÂÆπÂô®‚ÄìrmÔºåÊ≠§Êó∂Â§á‰ªΩÂ∞±Âú®ÂΩìÂâçÁöÑÁõÆÂΩï‰∏ãÔºåÂêç‰∏∫test.tar„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">ls</span> <span class="hljs-comment"># ÂÆø‰∏ªÊú∫ÂΩìÂâçÁõÆÂΩï‰∏ã‰∫ßÁîü‰∫Ü test Âç∑ÁöÑÂ§á‰ªΩÊñá‰ª∂ </span><br>test.tar test.tar<br></code></pre></td></tr></table></figure>
<h3 id="ÊÅ¢Â§ç"><a class="header-anchor" href="#ÊÅ¢Â§ç"></a>ÊÅ¢Â§ç</h3>
<p>‰Ω†ÂèØ‰ª•ÊÅ¢Â§çÁªôÂêå‰∏Ä‰∏™ÂÆπÂô®ÊàñËÄÖÂè¶Â§ñÁöÑÂÆπÂô®ÔºåÊñ∞Âª∫ÂÆπÂô®Âπ∂Ëß£ÂéãÂ§á‰ªΩÊñá‰ª∂Âà∞Êñ∞ÁöÑÂÆπÂô®Êï∞ÊçÆÂç∑</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i -d -v /test --name test4 ubuntu:14.04  /bin/bash <br>$ sudo docker run --<span class="hljs-built_in">rm</span> --volumes-from test4 -v $(<span class="hljs-built_in">pwd</span>):/backup ubuntu:14.04 tar xvf /backup/test.tar -C / <span class="hljs-comment"># ÊÅ¢Â§ç‰πãÂâçÁöÑÊñá‰ª∂Âà∞Êñ∞Âª∫Âç∑‰∏≠ÔºåÊâßË°åÂÆåÂêéËá™Âä®Âà†Èô§ÂÆπÂô® </span><br><span class="hljs-built_in">test</span>/ <span class="hljs-built_in">test</span>/b <span class="hljs-built_in">test</span>/d <span class="hljs-built_in">test</span>/c <span class="hljs-built_in">test</span>/a<br></code></pre></td></tr></table></figure>
<h2 id="8-4-Âà†Èô§-Volumes"><a class="header-anchor" href="#8-4-Âà†Èô§-Volumes"></a>8.4 Âà†Èô§ Volumes</h2>
<p>Volume Âè™ÊúâÂú®‰∏ãÂàóÊÉÖÂÜµ‰∏ãÊâçËÉΩË¢´Âà†Èô§Ôºö</p>
<ul>
<li>docker rm -vÂà†Èô§ÂÆπÂô®Êó∂Ê∑ªÂä†‰∫Ü-vÈÄâÈ°π</li>
<li>docker run --rmËøêË°åÂÆπÂô®Êó∂Ê∑ªÂä†‰∫Ü‚ÄìrmÈÄâÈ°π</li>
</ul>
<p>Âê¶ÂàôÔºå‰ºöÂú®/var/lib/docker/vfs/dirÁõÆÂΩï‰∏≠ÈÅóÁïôÂæàÂ§ö‰∏çÊòéÁõÆÂΩï„ÄÇ</p>
<p>ÂèÇËÄÉÊñáÊ°£Ôºö</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://docs.docker.com/userguide/dockervolumes/#data-volumes">Managing Data in Containers</a></li>
<li><a target="_blank" rel="noopener" href="http://dockerone.com/article/128">Ê∑±ÂÖ•ÁêÜËß£Docker VolumeÔºà‰∏ÄÔºâ</a></li>
<li><a target="_blank" rel="noopener" href="http://dockerone.com/article/129">Ê∑±ÂÖ•ÁêÜËß£Docker VolumeÔºà‰∫åÔºâ</a></li>
</ul>
<h1 id="‰πù„ÄÅÈìæÊé•ÂÆπÂô®"><a class="header-anchor" href="#‰πù„ÄÅÈìæÊé•ÂÆπÂô®"></a>‰πù„ÄÅÈìæÊé•ÂÆπÂô®</h1>
<p>docker ÂÖÅËÆ∏ÊääÂ§ö‰∏™ÂÆπÂô®ËøûÊé•Âú®‰∏ÄËµ∑ÔºåÁõ∏‰∫í‰∫§‰∫í‰ø°ÊÅØ„ÄÇdocker ÈìæÊé•‰ºöÂàõÂª∫‰∏ÄÁßçÂÆπÂô®Áà∂Â≠êÁ∫ßÂà´ÁöÑÂÖ≥Á≥ªÔºåÂÖ∂‰∏≠Áà∂ÂÆπÂô®ÂèØ‰ª•ÁúãÂà∞ÂÖ∂Â≠êÂÆπÂô®Êèê‰æõÁöÑ‰ø°ÊÅØ„ÄÇ</p>
<h2 id="9-1-ÂÆπÂô®ÂëΩÂêç"><a class="header-anchor" href="#9-1-ÂÆπÂô®ÂëΩÂêç"></a>9.1 ÂÆπÂô®ÂëΩÂêç</h2>
<p>Âú®ÂàõÂª∫ÂÆπÂô®Êó∂ÔºåÂ¶ÇÊûú‰∏çÊåáÂÆöÂÆπÂô®ÁöÑÂêçÂ≠óÔºåÂàôÈªòËÆ§‰ºöËá™Âä®ÂàõÂª∫‰∏Ä‰∏™ÂêçÂ≠óÔºåËøôÈáåÊé®ËçêÁªôÂÆπÂô®ÂëΩÂêçÔºö</p>
<ul>
<li>1„ÄÅÁªôÂÆπÂô®ÂëΩÂêçÊñπ‰æøËÆ∞ÂøÜÔºåÂ¶ÇÂëΩÂêçËøêË°å web Â∫îÁî®ÁöÑÂÆπÂô®‰∏∫ web</li>
<li>2„ÄÅ‰∏∫ docker ÂÆπÂô®Êèê‰æõ‰∏Ä‰∏™ÂèÇËÄÉÔºåÂÖÅËÆ∏Êñπ‰æøÂÖ∂‰ªñÂÆπÂô®Ë∞ÉÁî®ÔºåÂ¶ÇÊääÂÆπÂô® web ÈìæÊé•Âà∞ÂÆπÂô® db</li>
</ul>
<p>ÂèØ‰ª•ÈÄöËøá‚ÄìnameÈÄâÈ°πÁªôÂÆπÂô®Ëá™ÂÆö‰πâÂëΩÂêçÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -d -t -i --name <span class="hljs-built_in">test</span> ubuntu:14.04 bash              <br>$ sudo docker  inspect --format=<span class="hljs-string">&quot;&#123;&#123; .Nmae &#125;&#125;&quot;</span> <span class="hljs-built_in">test</span><br>/test<br></code></pre></td></tr></table></figure>
<blockquote>
<p>Ê≥®ÔºöÂÆπÂô®ÂêçÁß∞ÂøÖÈ°ªÂîØ‰∏ÄÔºåÂç≥‰Ω†Âè™ËÉΩÂëΩÂêç‰∏Ä‰∏™Âè´testÁöÑÂÆπÂô®„ÄÇÂ¶ÇÊûú‰Ω†ÊÉ≥Â§çÁî®ÂÆπÂô®ÂêçÔºåÂàôÂøÖÈ°ªÂú®ÂàõÂª∫Êñ∞ÁöÑÂÆπÂô®ÂâçÈÄöËøádocker rmÂà†Èô§ÊóßÁöÑÂÆπÂô®ÊàñËÄÖÂàõÂª∫ÂÆπÂô®Êó∂Ê∑ªÂä†‚ÄìrmÈÄâÈ°π„ÄÇ</p>
</blockquote>
<h2 id="9-2-ÈìæÊé•ÂÆπÂô®"><a class="header-anchor" href="#9-2-ÈìæÊé•ÂÆπÂô®"></a>9.2 ÈìæÊé•ÂÆπÂô®</h2>
<p>ÈìæÊé•ÂÖÅËÆ∏ÂÆπÂô®Èó¥ÂÆâÂÖ®ÈÄö‰ø°Ôºå‰ΩøÁî®‚ÄìlinkÈÄâÈ°πÂàõÂª∫ÈìæÊé•„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -d --name db training/postgres<br></code></pre></td></tr></table></figure>
<p>Âü∫‰∫é training/postgres ÈïúÂÉèÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ db ÁöÑÂÆπÂô®ÔºåÁÑ∂Âêé‰∏ãÈù¢ÂàõÂª∫‰∏Ä‰∏™Âè´ÂÅö web ÁöÑÂÆπÂô®ÔºåÂπ∂‰∏îÂ∞ÜÂÆÉ‰∏é db Áõ∏‰∫íËøûÊé•Âú®‰∏ÄËµ∑</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -d -P --name web --<span class="hljs-built_in">link</span> db:db training/webapp python app.py<br></code></pre></td></tr></table></figure>
<p>‚Äìlink <name or id>:aliasÈÄâÈ°πÊåáÂÆöÈìæÊé•Âà∞ÁöÑÂÆπÂô®„ÄÇ</p>
<p>Êü•Áúã web ÂÆπÂô®ÁöÑÈìæÊé•ÂÖ≥Á≥ª:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker inspect -f <span class="hljs-string">&quot;&#123;&#123; .HostConfig.Links &#125;&#125;&quot;</span> web<br>[/db:/web/db]<br></code></pre></td></tr></table></figure>
<p>ÂèØ‰ª•ÁúãÂà∞ web ÂÆπÂô®Ë¢´ÈìæÊé•Âà∞ db ÂÆπÂô®‰∏∫/web/dbÔºåËøôÂÖÅËÆ∏ web ÂÆπÂô®ËÆøÈóÆ db ÂÆπÂô®ÁöÑ‰ø°ÊÅØ„ÄÇ</p>
<p>ÂÆπÂô®‰πãÈó¥ÁöÑÈìæÊé•ÂÆûÈôÖÂÅö‰∫Ü‰ªÄ‰πàÔºü‰∏Ä‰∏™ÈìæÊé•ÂÖÅËÆ∏‰∏Ä‰∏™Ê∫êÂÆπÂô®Êèê‰æõ‰ø°ÊÅØËÆøÈóÆÁªô‰∏Ä‰∏™Êé•Êî∂ÂÆπÂô®„ÄÇÂú®Êú¨‰æã‰∏≠Ôºåweb ÂÆπÂô®‰Ωú‰∏∫‰∏Ä‰∏™Êé•Êî∂ËÄÖÔºåÂÖÅËÆ∏ËÆøÈóÆÊ∫êÂÆπÂô® db ÁöÑÁõ∏ÂÖ≥ÊúçÂä°‰ø°ÊÅØ„ÄÇDocker ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂÆâÂÖ®ÈößÈÅìËÄå‰∏çÈúÄË¶ÅÂØπÂ§ñÂÖ¨ÂºÄ‰ªª‰ΩïÁ´ØÂè£ÁªôÂ§ñÈÉ®ÂÆπÂô®ÔºåÂõ†Ê≠§‰∏çÈúÄË¶ÅÂú®ÂàõÂª∫ÂÆπÂô®ÁöÑÊó∂ÂÄôÊ∑ªÂä†-pÊàñ-PÊåáÂÆöÂØπÂ§ñÂÖ¨ÂºÄÁöÑÁ´ØÂè£ÔºåËøô‰πüÊòØÈìæÊé•ÂÆπÂô®ÁöÑÊúÄÂ§ßÂ•ΩÂ§ÑÔºåÊú¨‰æã‰∏∫ PostgreSQL Êï∞ÊçÆÂ∫ì„ÄÇ</p>
<p>Docker ‰∏ªË¶ÅÈÄöËøá‰ª•‰∏ã‰∏§‰∏™ÊñπÂºèÊèê‰æõËøûÊé•‰ø°ÊÅØÁªôÊé•Êî∂ÂÆπÂô®Ôºö</p>
<ul>
<li>ÁéØÂ¢ÉÂèòÈáè</li>
<li>Êõ¥Êñ∞/etc/hostsÊñá‰ª∂</li>
</ul>
<h3 id="ÁéØÂ¢ÉÂèòÈáè"><a class="header-anchor" href="#ÁéØÂ¢ÉÂèòÈáè"></a>ÁéØÂ¢ÉÂèòÈáè</h3>
<p>ÂΩì‰∏§‰∏™ÂÆπÂô®ÈìæÊé•ÔºåDocker ‰ºöÂú®ÁõÆÊ†áÂÆπÂô®‰∏äËÆæÁΩÆ‰∏Ä‰∫õÁéØÂ¢ÉÂèòÈáèÔºå‰ª•Ëé∑ÂèñÊ∫êÂÆπÂô®ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇ</p>
<p>È¶ñÂÖàÔºåDocker ‰ºöÂú®ÊØè‰∏™ÈÄöËøá‚ÄìlinkÈÄâÈ°πÊåáÂÆöÂà´ÂêçÁöÑÁõÆÊ†áÂÆπÂô®‰∏äËÆæÁΩÆ‰∏Ä‰∏™<alias>_NAMEÁéØÂ¢ÉÂèòÈáè„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™Âêç‰∏∫ web ÁöÑÂÆπÂô®ÈÄöËøá‚Äìlink db:webdbË¢´ÈìæÊé•Âà∞‰∏Ä‰∏™Âêç‰∏∫ db ÁöÑÊï∞ÊçÆÂ∫ìÂÆπÂô®ÔºåÈÇ£‰πà web ÂÆπÂô®‰∏ä‰ºöËÆæÁΩÆ‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáè‰∏∫WEBDB_NAME=/web/webdb.</p>
<p>‰ª•‰πãÂâçÁöÑ‰∏∫‰æãÔºåDocker Ëøò‰ºöËÆæÁΩÆÁ´ØÂè£ÂèòÈáè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run --<span class="hljs-built_in">rm</span> --name web2 --<span class="hljs-built_in">link</span> db:db training/webapp <span class="hljs-built_in">env</span><br>. . .<br>DB_NAME=/web2/db<br>DB_PORT=tcp://172.17.0.5:5432           <br>DB_PORT_5432_TCP=tcp://172.17.0.5:5432  <span class="hljs-comment"># &lt;name&gt;_PORT_&lt;port&gt;_&lt;protocol&gt; ÂçèËÆÆÂèØ‰ª•ÊòØ TCP Êàñ UDP</span><br>DB_PORT_5432_TCP_PROTO=tcp<br>DB_PORT_5432_TCP_PORT=5432<br>DB_PORT_5432_TCP_ADDR=172.17.0.5<br>. . .<br></code></pre></td></tr></table></figure>
<blockquote>
<p>Ê≥®ÔºöËøô‰∫õÁéØÂ¢ÉÂèòÈáèÂè™ËÆæÁΩÆÁªôÂÆπÂô®‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ËøõÁ®ãÔºåÁ±ª‰ºº‰∏Ä‰∫õÂÆàÊä§ËøõÁ®ã (Â¶Ç sshd ) ÂΩì‰ªñ‰ª¨Ê¥æÁîü shells Êó∂‰ºöÊ∏ÖÈô§Ëøô‰∫õÂèòÈáè</p>
</blockquote>
<h3 id="Êõ¥Êñ∞-etc-hostsÊñá‰ª∂"><a class="header-anchor" href="#Êõ¥Êñ∞-etc-hostsÊñá‰ª∂"></a>Êõ¥Êñ∞/etc/hostsÊñá‰ª∂</h3>
<p>Èô§‰∫ÜÁéØÂ¢ÉÂèòÈáèÔºåDocker ‰ºöÂú®ÁõÆÊ†áÂÆπÂô®‰∏äÊ∑ªÂä†Áõ∏ÂÖ≥‰∏ªÊú∫Êù°ÁõÆÂà∞/etc/hosts‰∏≠Ôºå‰∏ä‰æã‰∏≠Â∞±ÊòØ web ÂÆπÂô®„ÄÇ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo docker run -t -i --<span class="hljs-built_in">rm</span> --<span class="hljs-built_in">link</span> db:db training/webapp /bin/bash<br>root@aed84ee21bde:/opt/webapp<br><span class="hljs-comment"># cat /etc/hosts</span><br>172.17.0.7  aed84ee21bde<br>. . .<br>172.17.0.5  db<br></code></pre></td></tr></table></figure>
<blockquote>
<p>/etc/hostÊñá‰ª∂Âú®Ê∫êÂÆπÂô®Ë¢´ÈáçÂêØ‰πãÂêé‰ºöËá™Âä®Êõ¥Êñ∞ IP Âú∞ÂùÄÔºåËÄåÁéØÂ¢ÉÂèòÈáè‰∏≠ÁöÑ IP Âú∞ÂùÄÂàô‰∏ç‰ºöËá™Âä®Êõ¥Êñ∞ÁöÑ„ÄÇ</p>
</blockquote>
<h1 id="ÂçÅ„ÄÅÊûÑÂª∫ÁßÅÊúâÂ∫ì"><a class="header-anchor" href="#ÂçÅ„ÄÅÊûÑÂª∫ÁßÅÊúâÂ∫ì"></a>ÂçÅ„ÄÅÊûÑÂª∫ÁßÅÊúâÂ∫ì</h1>
<p>Docker ÂÆòÊñπÊèê‰æõ‰∫Ü docker registry ÁöÑÊûÑÂª∫ÊñπÊ≥ï¬†<a target="_blank" rel="noopener" href="https://github.com/docker/docker-registry">docker-registry</a></p>
<h2 id="10-1-Âø´ÈÄüÊûÑÂª∫"><a class="header-anchor" href="#10-1-Âø´ÈÄüÊûÑÂª∫"></a>10.1 Âø´ÈÄüÊûÑÂª∫</h2>
<p>Âø´ÈÄüÊûÑÂª∫ docker registry ÈÄöËøá‰ª•‰∏ã‰∏§Ê≠•:</p>
<ul>
<li>ÂÆâË£Ö docker</li>
<li>ËøêË°å registry:docker run -p 5000:5000 registry</li>
</ul>
<p>ËøôÁßçÊñπÊ≥ïÈÄöËøá Docker hub ‰ΩøÁî®ÂÆòÊñπÈïúÂÉè¬†<a target="_blank" rel="noopener" href="https://registry.hub.docker.com/_/registry/">official image from the Docker hub</a></p>
<h2 id="10-2-‰∏ç‰ΩøÁî®ÂÆπÂô®ÊûÑÂª∫-registry"><a class="header-anchor" href="#10-2-‰∏ç‰ΩøÁî®ÂÆπÂô®ÊûÑÂª∫-registry"></a>10.2 ‰∏ç‰ΩøÁî®ÂÆπÂô®ÊûÑÂª∫ registry</h2>
<h3 id="ÂÆâË£ÖÂøÖË¶ÅÁöÑËΩØ‰ª∂"><a class="header-anchor" href="#ÂÆâË£ÖÂøÖË¶ÅÁöÑËΩØ‰ª∂"></a>ÂÆâË£ÖÂøÖË¶ÅÁöÑËΩØ‰ª∂</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo apt-get install build-essential python-dev libevent-dev python-pip liblzma-dev<br></code></pre></td></tr></table></figure>
<h3 id="ÈÖçÁΩÆ-docker-registry"><a class="header-anchor" href="#ÈÖçÁΩÆ-docker-registry"></a>ÈÖçÁΩÆ docker-registry</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo pip install docker-registry<br></code></pre></td></tr></table></figure>
<p>ÊàñËÄÖ ‰ΩøÁî® github clone ÊâãÂä®ÂÆâË£Ö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> https://github.com/dotcloud/docker-registry.git<br>$ <span class="hljs-built_in">cd</span> docker-registry/<br>$ <span class="hljs-built_in">cp</span> config/config_sample.yml config/config.yml<br>$ <span class="hljs-built_in">mkdir</span> /data/registry -p<br>$ pip install .<br></code></pre></td></tr></table></figure>
<h3 id="ËøêË°å"><a class="header-anchor" href="#ËøêË°å"></a>ËøêË°å</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-registry<br></code></pre></td></tr></table></figure>
<h3 id="È´òÁ∫ßÂêØÂä®ÊñπÂºè-‰∏çÊé®Ëçê"><a class="header-anchor" href="#È´òÁ∫ßÂêØÂä®ÊñπÂºè-‰∏çÊé®Ëçê"></a>È´òÁ∫ßÂêØÂä®ÊñπÂºè [‰∏çÊé®Ëçê]</h3>
<p>‰ΩøÁî®gunicornÊéßÂà∂:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunicorn -c contrib/gunicorn_config.py docker_registry.wsgi:application<br></code></pre></td></tr></table></figure>
<p>ÊàñËÄÖÂØπÂ§ñÁõëÂê¨ÂºÄÊîæ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunicorn --access-logfile - --error-logfile - -k gevent -b 0.0.0.0:5000 -w 4 --max-requests 100 docker_registry.wsgi:application<br></code></pre></td></tr></table></figure>
<h2 id="10-3-Êèê‰∫§ÊåáÂÆöÂÆπÂô®Âà∞ÁßÅÊúâÂ∫ì"><a class="header-anchor" href="#10-3-Êèê‰∫§ÊåáÂÆöÂÆπÂô®Âà∞ÁßÅÊúâÂ∫ì"></a>10.3 Êèê‰∫§ÊåáÂÆöÂÆπÂô®Âà∞ÁßÅÊúâÂ∫ì</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker tag ubuntu:12.04 ÁßÅÊúâÂ∫ìIP:5000/ubuntu:12.04<br>$ docker push ÁßÅÊúâÂ∫ìIP:5000/ubuntu<br></code></pre></td></tr></table></figure>
<p>Êõ¥Â§öÁöÑÈÖçÁΩÆÈÄâÈ°πÊé®ËçêÈòÖËØªÂÆòÊñπÊñáÊ°£:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/docker/docker-registry/blob/master/README.md">Docker-Registry README</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/docker/docker-registry/blob/master/ADVANCED.md">Docker-Registry advanced use</a></li>
</ul>
<p>Êù•Ëá™Ôºö<a target="_blank" rel="noopener" href="http://opskumu.github.io/docker.html">http://opskumu.github.io/docker.html</a></p>

                
              </div>
            
            <hr/>
            <div>

              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ÈùûÂ∏∏ËØ¶ÁªÜÁöÑDockerÂ≠¶‰π†Á¨îËÆ∞</div>
      <div>http://www.tung7.com/‰ªñÂ±±‰πãÁü≥/detail_docker_study_note.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Tung</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>August 6, 2016</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - Non-commercial">
                    <i class="iconfont icon-nc"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - Share-alike">
                    <i class="iconfont icon-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2 side-col-post-right">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
<!--    <i class="iconfont icon-list"></i>-->
    üìí<span>TOC</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.events.registerRefreshCallback(function() {
      if ('mermaid' in window) {
        mermaid.init();
      }
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://github.com/hexojs/hexo" target="_blank">Hexo</a>üî∏<a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank">Fluid</a> <br> ¬©Ô∏è 2015-2023‚ù§Ô∏èTung7 ÁâàÊùÉÊâÄÊúâ | <a href="http://beian.miit.gov.cn" target="_blank" style="border-bottom:1px solid">Á≤§ICPÂ§á15069283Âè∑</a> 
    </div>
  
  
  
    <!-- Â§áÊ°à‰ø°ÊÅØ ICP for China -->
    <div class="beian">
  <span>
      
  </span>
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
